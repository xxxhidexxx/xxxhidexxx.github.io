<!DOCTYPE html>
<html><head>
<title>蓝队进阶攻略</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="各种场景的应急，安全设备的使用，网络安全知识储备，java 反序列化的原理和特征，防御红队的攻击和钓鱼">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="蓝队进阶攻略" />
<meta property="og:description" content="各种场景的应急，安全设备的使用，网络安全知识储备，java 反序列化的原理和特征，防御红队的攻击和钓鱼" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xxxhidexxx.github.io/posts/sec/hvv/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-05-18T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="蓝队进阶攻略"/>
<meta name="twitter:description" content="各种场景的应急，安全设备的使用，网络安全知识储备，java 反序列化的原理和特征，防御红队的攻击和钓鱼"/>









<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css" integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>
















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    分类
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ba%94%e6%80%a5%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-应急类问题">
									应急类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ba%94%e6%80%a5%e9%97%ae%e9%a2%98%e7%9a%84%e5%9b%9e%e7%ad%94%e5%85%ac%e5%bc%8f" class="nav-应急问题的回答公式">
									应急问题的回答公式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%a0%e5%88%b0%e5%ae%a2%e6%88%b7%e7%8e%b0%e5%9c%ba%e8%bf%9b%e8%a1%8c%e5%ae%89%e5%85%a8%e5%8a%a0%e5%9b%ba%e9%83%bd%e8%a6%81%e5%81%9a%e5%93%aa%e4%ba%9b%e4%ba%8b" class="nav-你到客户现场进行安全加固都要做哪些事">
									你到客户现场进行安全加固都要做哪些事
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e8%ae%be%e5%a4%87%e5%91%8a%e8%ad%a6%e6%98%af%e4%b8%8d%e6%98%af%e8%af%af%e6%8a%a5" class="nav-怎么判断设备告警是不是误报">
									怎么判断设备告警是不是误报
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e8%80%85%e5%9c%a8%e5%a4%96%e7%bd%91%e4%bd%86%e6%98%af%e8%ae%be%e5%a4%87%e5%87%ba%e7%8e%b0%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e6%80%8e%e4%b9%88%e8%a7%a3%e9%87%8a%e8%bf%99%e7%a7%8d%e7%8e%b0%e8%b1%a1%e6%80%8e%e4%b9%88%e7%9c%8b%e5%88%b0%e7%9c%9f%e5%ae%9e-ip" class="nav-攻击者在外网但是设备出现内网告警怎么解释这种现象怎么看到真实-ip">
									攻击者在外网，但是设备出现内网告警，怎么解释这种现象，怎么看到真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e4%b8%ba%e7%9c%9f%e5%ae%9e%e5%a8%81%e8%83%81%e4%bd%a0%e4%bc%9a%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-已知内网告警为真实威胁你会怎么做">
									已知内网告警为真实威胁，你会怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e5%86%85%e7%bd%91%e6%a8%aa%e5%90%91%e7%a7%bb%e5%8a%a8%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-已知内网横向移动怎么办">
									已知内网横向移动，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%b4%a7%e6%80%a5%e9%80%9a%e7%9f%a5-windows-%e7%b3%bb%e7%bb%9f%e6%9c%89%e4%ba%ba%e7%82%b9%e5%87%bb%e9%92%93%e9%b1%bc%e6%96%87%e4%bb%b6%e4%ba%86%e4%bd%a0%e8%b4%9f%e8%b4%a3%e6%8e%92%e6%9f%a5%e8%bf%9c%e7%a8%8b%e6%a1%8c%e9%9d%a2%e5%ba%94%e8%af%a5%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-紧急通知-windows-系统有人点击钓鱼文件了你负责排查远程桌面应该怎么做">
									紧急通知 windows 系统有人点击钓鱼文件了，你负责排查远程桌面，应该怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ddos-%e7%9a%84%e5%8a%a0%e5%9b%ba%e5%92%8c%e5%a4%84%e7%bd%ae" class="nav-ddos-的加固和处置">
									ddos 的加固和处置
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e7%bd%91%e9%a1%b5%e7%af%a1%e6%94%b9%e4%bd%a0%e4%bc%9a%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-发现网页篡改你会怎么做">
									发现网页篡改，你会怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5-webshell-%e4%b8%8a%e4%bc%a0%e4%bd%a0%e5%ba%94%e8%af%a5%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-已知-webshell-上传你应该怎么做">
									已知 webshell 上传，你应该怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5-dns-%e5%91%8a%e8%ad%a6%e4%b8%80%e5%ae%9a%e6%98%af%e6%84%9f%e6%9f%93%e5%90%97%e5%8f%af%e8%83%bd%e7%9a%84%e5%8e%9f%e5%9b%a0%e6%98%af%e4%bb%80%e4%b9%88" class="nav-已知-dns-告警一定是感染吗可能的原因是什么">
									已知 DNS 告警，一定是感染吗，可能的原因是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%b7%b2%e7%bb%8f%e4%b8%ad%e4%ba%86%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-发现已经中了勒索病毒怎么办">
									发现已经中了勒索病毒，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%b7%b2%e7%bb%8f%e4%b8%ad%e4%ba%86%e6%8c%96%e7%9f%bf%e6%9c%a8%e9%a9%ac%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-发现已经中了挖矿木马怎么办">
									发现已经中了挖矿木马，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e8%ae%be%e5%a4%87%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-设备类问题">
									设备类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89" class="nav-天眼每个字段的含义">
									天眼每个字段的含义
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e7%9a%84%e7%bb%93%e6%9e%9c%e9%99%a4%e4%ba%86%e6%88%90%e5%8a%9f%e8%bf%98%e6%9c%89%e5%93%aa%e4%ba%9b%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad" class="nav-天眼告警的结果除了成功还有哪些怎么判断">
									天眼告警的结果除了成功还有哪些，怎么判断
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%86%85%e7%bd%91%e6%a8%aa%e5%90%91%e7%9a%84%e5%91%8a%e8%ad%a6%e7%b1%bb%e5%9e%8b" class="nav-天眼内网横向的告警类型">
									天眼内网横向的告警类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e9%80%9a%e8%bf%87%e5%a4%a9%e7%9c%bc%e5%88%a4%e6%96%ad%e8%b5%84%e4%ba%a7%e6%98%af%e5%90%a6%e5%a4%b1%e9%99%b7" class="nav-怎么通过天眼判断资产是否失陷">
									怎么通过天眼判断资产是否失陷
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%a4%a9%e7%9c%bc%e4%b8%ad%e5%8f%97%e5%ae%b3-ip-%e4%b8%ba%e6%ba%90-ip%e6%80%8e%e4%b9%88%e8%a7%a3%e9%87%8a" class="nav-发现天眼中受害-ip-为源-ip怎么解释">
									发现天眼中受害 ip 为源 ip，怎么解释
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%88%86%e6%9e%90%e5%b9%b3%e5%8f%b0%e4%b8%ad-ioc-%e8%a1%a8%e7%a4%ba%e4%bb%80%e4%b9%88%e5%90%ab%e4%b9%89%e5%8f%8d%e6%98%a0%e4%ba%86%e4%bb%80%e4%b9%88" class="nav-天眼分析平台中-ioc-表示什么含义反映了什么">
									天眼分析平台中 IOC 表示什么含义，反映了什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%88%86%e6%9e%90%e5%b9%b3%e5%8f%b0%e7%9a%84%e8%bf%90%e7%ae%97%e7%ac%a6%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-天眼分析平台的运算符有哪些">
									天眼分析平台的运算符有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e4%b8%80%e4%b8%aa%e5%a4%a9%e7%9c%bc%e6%97%a5%e5%bf%97%e8%a6%81%e6%b1%82%e6%90%9c%e7%b4%a2-80-%e5%92%8c-443-%e7%ab%af%e5%8f%a3%e7%9a%84%e8%ae%b0%e5%bd%95%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-给定一个天眼日志要求搜索-80-和-443-端口的记录怎么做">
									给定一个天眼日志，要求搜索 80 和 443 端口的记录，怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e4%b8%80%e4%b8%aa%e5%a4%a9%e7%9c%bc%e6%97%a5%e5%bf%97%e8%a6%81%e6%b1%82%e6%90%9c%e7%b4%a2%e6%ba%90-ip-%e4%b8%ba-a-%e5%b9%b6%e4%b8%94%e7%9b%ae%e7%9a%84-ip-%e4%b8%ba-b-%e7%9a%84%e6%97%a5%e5%bf%97%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-给定一个天眼日志要求搜索源-ip-为-a-并且目的-ip-为-b-的日志怎么做">
									给定一个天眼日志，要求搜索源 ip 为 A 并且目的 ip 为 B 的日志，怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e6%a8%a1%e7%b3%8a%e6%90%9c%e7%b4%a2%e6%80%8e%e4%b9%88%e5%86%99%e6%9f%a5%e8%af%a2%e8%af%ad%e5%8f%a5" class="nav-天眼模糊搜索怎么写查询语句">
									天眼模糊搜索怎么写查询语句
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e4%b8%bb%e6%9c%ba%e5%a4%96%e8%81%94%e6%b5%81%e9%87%8f%e6%80%8e%e4%b9%88%e6%8e%92%e6%9f%a5" class="nav-天眼告警主机外联流量怎么排查">
									天眼告警主机外联流量，怎么排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e6%98%be%e7%a4%ba%e6%88%90%e5%8a%9f%e5%88%a9%e7%94%a8%e6%80%8e%e4%b9%88%e5%a4%84%e7%90%86" class="nav-天眼告警显示成功利用怎么处理">
									天眼告警显示成功利用，怎么处理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%a8%e8%bf%87-edr-%e8%ae%be%e5%a4%87%e5%90%97" class="nav-用过-edr-设备吗">
									用过 edr 设备吗
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e7%94%a8%e7%9a%84-wireshark-%e8%bf%87%e6%bb%a4%e8%af%ad%e6%b3%95%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-常用的-wireshark-过滤语法有哪些">
									常用的 wireshark 过滤语法有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%af%86%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-常识类问题">
									常识类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0%e6%9c%89%e5%93%aa%e4%ba%9b%e9%99%90%e5%88%b6%e6%80%8e%e4%b9%88%e7%bb%95%e8%bf%87" class="nav-文件上传有哪些限制怎么绕过">
									文件上传有哪些限制，怎么绕过
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#redis-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e5%9c%a8%e4%bb%80%e4%b9%88%e6%9d%a1%e4%bb%b6%e4%b8%8b%e8%83%bd%e5%81%9a%e5%88%b0-rce%e6%80%8e%e4%b9%88%e5%8a%a0%e5%9b%ba" class="nav-redis-未授权访问在什么条件下能做到-rce怎么加固">
									redis 未授权访问在什么条件下能做到 rce，怎么加固
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ssrf-%e7%94%a8-redis-%e6%8f%90%e5%8d%87%e4%b8%ba-rce" class="nav-ssrf-用-redis-提升为-rce">
									ssrf 用 redis 提升为 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e7%9c%8b-webshell-%e7%9a%84%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e5%8e%86%e5%8f%b2" class="nav-怎么看-webshell-的命令执行历史">
									怎么看 webshell 的命令执行历史
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#java-%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-java-类问题">
									java 类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#java-%e5%86%85%e5%ad%98%e9%a9%ac%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-java-内存马的原理">
									java 内存马的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-web-%e4%b8%ad-servletfilterlistener-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-java-web-中-servletfilterlistener-的区别">
									java web 中 servlet/filter/listener 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%8e%92%e6%9f%a5%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样排查内存马">
									怎样排查内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样清除内存马">
									怎样清除内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e5%ad%98%e9%a9%ac%e6%97%a0%e6%96%87%e4%bb%b6%e8%90%bd%e5%9c%b0%e6%80%8e%e4%b9%88%e5%8f%96%e8%af%81" class="nav-内存马无文件落地怎么取证">
									内存马无文件落地，怎么取证
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e%e6%a6%82%e8%bf%b0" class="nav-java-反序列化漏洞概述">
									java 反序列化漏洞概述
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%88%a9%e7%94%a8%e5%b7%a5%e5%85%b7" class="nav-java-反序列化利用工具">
									java 反序列化利用工具
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#jndi-%e6%b3%a8%e5%85%a5%e6%98%af%e4%bb%80%e4%b9%88" class="nav-jndi-注入是什么">
									jndi 注入是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#rmi-%e6%98%af%e4%bb%80%e4%b9%88" class="nav-rmi-是什么">
									rmi 是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81550-%e5%92%8c-721-%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" class="nav-shiro-的流量特征550-和-721-有什么区别">
									shiro 的流量特征，550 和 721 有什么区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e5%88%a9%e7%94%a8%e9%93%be" class="nav-shiro-利用链">
									shiro 利用链
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e7%9a%84%e5%8e%9f%e7%90%86%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e5%88%a9%e7%94%a8%e6%88%90%e5%8a%9f" class="nav-log4j2-的原理怎么判断是否利用成功">
									log4j2 的原理，怎么判断是否利用成功
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-log4j2-的流量特征">
									log4j2 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e6%94%bb%e5%87%bb%e8%80%85%e6%ad%a3%e5%9c%a8%e5%88%a9%e7%94%a8-log4j2-%e6%bc%8f%e6%b4%9e%e6%80%8e%e4%b9%88%e5%ba%94%e6%80%a5" class="nav-已知攻击者正在利用-log4j2-漏洞怎么应急">
									已知攻击者正在利用 log4j2 漏洞，怎么应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#struts2-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%8e%9f%e7%90%86" class="nav-struts2-反序列化原理">
									struts2 反序列化原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#struts2-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-struts2-的流量特征">
									struts2 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#weblogic-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-weblogic-的流量特征">
									weblogic 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#weblogic-%e5%8e%86%e5%8f%b2%e6%bc%8f%e6%b4%9e" class="nav-weblogic-历史漏洞">
									weblogic 历史漏洞
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-fastjson-反序列化的原理">
									fastjson 反序列化的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-fastjson-的流量特征">
									fastjson 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#fastjson-rce-%e6%b5%81%e7%a8%8b" class="nav-fastjson-rce-流程">
									fastjson rce 流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#fastjson-%e4%b8%8d%e5%87%ba%e7%bd%91%e6%80%8e%e4%b9%88%e5%88%a9%e7%94%a8" class="nav-fastjson-不出网怎么利用">
									fastjson 不出网怎么利用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e5%92%8c-fastjson-%e8%81%94%e5%8a%a8" class="nav-log4j2-和-fastjson-联动">
									log4j2 和 fastjson 联动
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%ba%a2%e8%93%9d%e5%af%b9%e6%8a%97%e9%97%ae%e9%a2%98" class="nav-红蓝对抗问题">
									红蓝对抗问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#cobaltstrike-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-cobaltstrike-的流量特征">
									CobaltStrike 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#metasploitframework-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-metasploitframework-的流量特征">
									MetasploitFramework 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%b0%e8%9d%8e%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-冰蝎的流量特征">
									冰蝎的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%8f%9c%e5%88%80-caidao" class="nav-菜刀-caidao">
									菜刀 caidao
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%93%a5%e6%96%af%e6%8b%89-godzilla" class="nav-哥斯拉-godzilla">
									哥斯拉 godzilla
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%9a%81%e5%89%91-antsword" class="nav-蚁剑-antsword">
									蚁剑 antsword
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://xxxhidexxx.github.io/">
            write-up
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://xxxhidexxx.github.io/">
        <div class="single-column-header-title">write-up</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    蓝队进阶攻略
                    
                    <div class="post-subtitle">
                        各种场景的应急，安全设备的使用，网络安全知识储备，java 反序列化的原理和特征，防御红队的攻击和钓鱼
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2024-05-18 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/sec">sec</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/%E8%93%9D%E9%98%9F%E7%90%86%E8%AE%BA">蓝队理论</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h2 id="应急类问题">应急类问题</h2>
<hr>
<h3 id="应急问题的回答公式">应急问题的回答公式</h3>
<p>先隔离出现问题的主机；判断影响范围；找到漏洞源头；清除攻击载荷；安全加固，修复漏洞；溯源分析；输出报告。</p>
<p>根据具体情况选择性填充细节。</p>
<hr>
<h3 id="你到客户现场进行安全加固都要做哪些事">你到客户现场进行安全加固都要做哪些事</h3>
<p>检查弱口令和未授权访问；确定开启了日志的审计功能；检查防火墙策略，关闭不必要的端口；停止不必要的服务，修改不必要的权限；检查系统补丁；更新中间件版本。</p>
<hr>
<h3 id="怎么判断设备告警是不是误报">怎么判断设备告警是不是误报</h3>
<p>看 ip 是否来自内网，是否为正常业务。记录正常业务的特征，方便后续判断，避免封禁 ip 影响业务。</p>
<p>看流量特征是否为恶意，根据具体的 payload 判断是否攻击成功。例如攻击者扫描返回 400，或者使用的 poc 是我们没有用到的组件，那么这些告警没有产生危害，封 ip 进行预防即可。</p>
<p>在封 ip 之前可以看一下这个 ip 的访问历史都是什么内容，可以在天眼中使用 sip eq x.x.x.x 进行过滤。</p>
<hr>
<h3 id="攻击者在外网但是设备出现内网告警怎么解释这种现象怎么看到真实-ip">攻击者在外网，但是设备出现内网告警，怎么解释这种现象，怎么看到真实 ip</h3>
<p>可能是安全设备误报，在安全设备采集数据的时候把一些 ip 转换成了内网 ip 导致告警显示的是内网，出现这种误报可能是安全设备在网络拓扑中的位置错了；可能是 ip 欺骗，例如 xff 请求头伪造；可能有 ssrf 漏洞可以访问内网；可能有失陷主机正在进行横向移动。</p>
<p>需要根据告警内容排查是否为误报。</p>
<p>可以通过 x-forwarded-for 看真实 ip，其中 xff 的几项分别为：真实 ip，代理 ip-1，代理 ip-2，&hellip;</p>
<hr>
<h3 id="已知内网告警为真实威胁你会怎么做">已知内网告警为真实威胁，你会怎么做</h3>
<p>先判断是否为蜜罐。</p>
<p>根据告警信息定位出现问题的设备，路由器 arp 缓存表可以找内网 ip 对应的 mac 地址。</p>
<p>对告警的主机进行隔离，对影响范围内的主机进行排查。</p>
<p>清除攻击载荷。</p>
<p>根据日志进行分析和溯源，调查攻击方法，建立攻击者画像。</p>
<p>协助恢复业务，输出报告。</p>
<hr>
<h3 id="已知内网横向移动怎么办">已知内网横向移动，怎么办</h3>
<p>隔离失陷主机，备份环境，判断横向移动的影响范围。</p>
<p>判断攻击方式，查找漏洞源头，评估攻击者的目的。</p>
<p>清除后门，修复漏洞，安全加固。</p>
<p>查看蜜罐等安全设备和日志文件，进行溯源。</p>
<hr>
<h3 id="紧急通知-windows-系统有人点击钓鱼文件了你负责排查远程桌面应该怎么做">紧急通知 windows 系统有人点击钓鱼文件了，你负责排查远程桌面，应该怎么做</h3>
<p>打开注册表禁用远程桌面。</p>
<p>在注册表里面找远程桌面连接的历史记录。</p>
<p>找 3389 端口的外联流量。</p>
<p>如果有远程桌面连接应立刻通报研判组和客户，进行溯源。</p>
<hr>
<h3 id="ddos-的加固和处置">ddos 的加固和处置</h3>
<p>加固：部署负载均衡、多节点、cdn、集群；部署抗 ddos 设备、流量监控设备；关闭非必要端口。</p>
<p>处置：判断 ddos 的类型（网络层、传输层、应用层）；封禁异常访问的 ip；保留攻击期间的 ip 进行取证；调整安全设备的防护策略；联系运营商清洗流量。</p>
<hr>
<h3 id="发现网页篡改你会怎么做">发现网页篡改，你会怎么做</h3>
<p>隔离被感染主机。</p>
<p>排查业务系统，判断影响范围。</p>
<p>确定漏洞源头。</p>
<p>修复漏洞，加固系统。</p>
<p>查找数据备份，恢复业务。</p>
<p>查询日志和设备告警记录进行溯源反制，建立攻击者画像。</p>
<p>输出报告。</p>
<hr>
<h3 id="已知-webshell-上传你应该怎么做">已知 webshell 上传，你应该怎么做</h3>
<p>首先对失陷的主机进行隔离，看情况可以断网。</p>
<p>然后确定 webshell 的位置和创建时间，可以用 D 盾、河马等工具，也可以自己查看日志文件。</p>
<p>清除 webshell 之后排查是否留有后门。</p>
<p>通过日志查看是否进行了危险操作。查看是否有新增用户。查看可疑的进程、服务、网络连接。</p>
<p>排查后门之后报告漏洞点，提供加固修复的建议。</p>
<p>通过日志进行溯源，建立攻击者画像。</p>
<p>整理工作，输出一份报告。</p>
<hr>
<h3 id="已知-dns-告警一定是感染吗可能的原因是什么">已知 DNS 告警，一定是感染吗，可能的原因是什么</h3>
<p>可能是感染，也可能是历史情报相似的可疑访问。</p>
<hr>
<h3 id="发现已经中了勒索病毒怎么办">发现已经中了勒索病毒，怎么办</h3>
<p>隔离感染的主机，判断影响范围。</p>
<p>判断勒索病毒的种类，可以在病毒库中进行搜索，查找解密工具。</p>
<p>找到漏洞源头，进行修复和系统加固。</p>
<p>查看日志和设备告警记录进行溯源，建立攻击者画像。</p>
<p>协助恢复数据和业务，输出报告。</p>
<hr>
<h3 id="发现已经中了挖矿木马怎么办">发现已经中了挖矿木马，怎么办</h3>
<p>隔离被感染的主机，判断影响范围。</p>
<p>找到挖矿进程并终止。如果隐藏了进程可以使用一些工具进行排查，例如 linux 的 unhide。</p>
<p>清除可疑的定时任务和非必要服务。</p>
<p>根据系统日志文件排查后门，清除木马和后门。</p>
<p>找到漏洞源头，进行修复和加固。</p>
<p>协助恢复业务，输出报告。</p>
<hr>
<h2 id="设备类问题">设备类问题</h2>
<hr>
<h3 id="天眼每个字段的含义">天眼每个字段的含义</h3>
<p>sip 源 ip，dip 为目的 ip，sport 为源端口，dport 为目的端口。</p>
<p>attack sip 表示攻击者的 ip。</p>
<p>dns type 字段，0 表示 dns 请求，1 表示 dns 响应，addr 表示该 host 对应的 ip 地址，可能有多个记录。</p>
<p>proto 字段表示协议。</p>
<p>from 字段表示发件人。</p>
<p>GEO 字段表示 ip 的物理位置。</p>
<hr>
<h3 id="天眼告警的结果除了成功还有哪些怎么判断">天眼告警的结果除了成功还有哪些，怎么判断</h3>
<p>成功，失败，尝试，未知。未知一般是告警误报。</p>
<hr>
<h3 id="天眼内网横向的告警类型">天眼内网横向的告警类型</h3>
<p>基于 cs 的告警，隧道类的告警，内网段进行漏洞扫描的告警，源于内网的暴力破解的告警。</p>
<hr>
<h3 id="怎么通过天眼判断资产是否失陷">怎么通过天眼判断资产是否失陷</h3>
<p>不断外联恶意地址，有 webshell 连接的告警或者隧道类的告警，就可以判断为资产已经失陷。</p>
<hr>
<h3 id="发现天眼中受害-ip-为源-ip怎么解释">发现天眼中受害 ip 为源 ip，怎么解释</h3>
<p>可能是安全设备配置错误导致的误报；可能是 ip 欺骗，xff 请求头伪造；也可能是 ssrf 或者内网横向。</p>
<hr>
<h3 id="天眼分析平台中-ioc-表示什么含义反映了什么">天眼分析平台中 IOC 表示什么含义，反映了什么</h3>
<p>IOC 表示匹配成功的威胁情报。</p>
<p>IOC 反映了主机的失陷特征信息，包括：入侵工具、恶意软件和攻击者画像。</p>
<hr>
<h3 id="天眼分析平台的运算符有哪些">天眼分析平台的运算符有哪些</h3>
<p>AND，OR，NOT。</p>
<hr>
<h3 id="给定一个天眼日志要求搜索-80-和-443-端口的记录怎么做">给定一个天眼日志，要求搜索 80 和 443 端口的记录，怎么做</h3>
<p>语法 sport eq 80 OR sport eq 443 OR dport eq 80 OR dport eq 443。</p>
<hr>
<h3 id="给定一个天眼日志要求搜索源-ip-为-a-并且目的-ip-为-b-的日志怎么做">给定一个天眼日志，要求搜索源 ip 为 A 并且目的 ip 为 B 的日志，怎么做</h3>
<p>语法 sip(A) AND dip(B)，其中 AND 要大写。</p>
<hr>
<h3 id="天眼模糊搜索怎么写查询语句">天眼模糊搜索怎么写查询语句</h3>
<p>搜索关键词，用 * 号加部分名称进行模糊搜索。</p>
<hr>
<h3 id="天眼告警主机外联流量怎么排查">天眼告警主机外联流量，怎么排查</h3>
<p>要判断外联的地址是否为恶意网址或者 dnslog 平台。</p>
<p>通过威胁情报平台判断外链地址是否是恶意或者是 dnslog 平台。</p>
<p>如果判断为恶意或 dnslog 并且连接次数较多，可判断主机异常。</p>
<hr>
<h3 id="天眼告警显示成功利用怎么处理">天眼告警显示成功利用，怎么处理</h3>
<p>根据告警类型分析回显，初步判断是否为误报。如果数据包无法判断，则尝试复现攻击。</p>
<p>在确认成功利用之后，立刻通报研判组和客户，进行应急。</p>
<p>如果确认是误报，则使用分析平台查看攻击 ip 的其他攻击行为和攻击结果，将发现时间和攻击行为反馈给客户。</p>
<hr>
<h3 id="用过-edr-设备吗">用过 edr 设备吗</h3>
<p>edr 就是终端安全响应，在之前实习的单位用过深信服的 edr，主要是做基线安全加固。深信服 edr 打补丁不需要重启服务，印象比较深刻。</p>
<p>深信服 edr 的基线合规检查项举例：密码策略、账户检测、安全审计策略、登录检测、防火墙、自动更新、非必要服务、防暴力破解、永恒之蓝检测、防恶意代码。</p>
<hr>
<h3 id="常用的-wireshark-过滤语法有哪些">常用的 wireshark 过滤语法有哪些</h3>
<p>搜索 ip 为 127.0.0.1 的流量可以用 ip.src eq 127.0.0.1 or ip.dst eq 127.0.0.1 或者 ip.addr eq 127.0.0.1。</p>
<p>搜索端口为 80 的流量可以用 tcp.port eq 80 or udp.port eq 80。</p>
<p>搜索 tcp 协议并忽略 udp 协议可以用 tcp and !udp。</p>
<p>搜索 uri 中含有 .mp3 的请求可以用 http.request.uri contains “.mp3”</p>
<p>搜索 post 请求可以用 http.request.method == “POST”。</p>
<hr>
<h2 id="常识类问题">常识类问题</h2>
<hr>
<h3 id="文件上传有哪些限制怎么绕过">文件上传有哪些限制，怎么绕过</h3>
<p>黑名单：限制 php 后缀，用大小写 PhP 或者 php5，phtml 进行绕过。</p>
<p>白名单：只允许特定后缀通过，可以使用 00 截断。</p>
<p>mime 校验：限制了 content-type。</p>
<p>文件头信息：每种类型的文件都有特定的文件头，也就是通过前几个 bit 验证文件类型。</p>
<p>绕过技巧：（1）后缀名用空格或者置空，例如“1.php ”，“1.php. ”，“1.php.”；（2）参数污染，filename=aaaaaaaaaaa1.php，filename===1.php，filename =1.php；（3）回车换行 shell.php.换行jpg；（4）双写，Content-Disposition: form-data; name=&ldquo;file&rdquo;; filename=shell.jpg;filename=shell.jspx; Content-Disposition: form-data; name=&ldquo;file&rdquo;; filename=shell.jpg;filename=shell.jspx.jpg。</p>
<hr>
<h3 id="redis-未授权访问在什么条件下能做到-rce怎么加固">redis 未授权访问在什么条件下能做到 rce，怎么加固</h3>
<p>redis 未授权访问的条件：（1）redis 默认的 6379 端口可以在公网访问；（2）redis 密码使用弱口令。</p>
<p>后续 rce 利用及其条件：方法 1，写 ssh，需要服务器有 .ssh 目录并且 redis 有写入权限。方法 2，写 webshell，需要知道 web 的绝对路径。方法 3，主从复制，需要 redis 版本大于等于 4.x，无其他条件。</p>
<p>加固：防火墙限制外网访问 6379 端口，redis 设置强密码。</p>
<hr>
<h3 id="ssrf-用-redis-提升为-rce">ssrf 用 redis 提升为 rce</h3>
<p>场景：redis 端口无法在外网访问，用 ssrf 进内网访问 redis 写 shell。</p>
<p>用 dict 协议探测，用 gopher 协议写入。直接写 webshell 还是需要知道 web 的绝对路径，例如 /var/www/html。</p>
<hr>
<h3 id="怎么看-webshell-的命令执行历史">怎么看 webshell 的命令执行历史</h3>
<p>windows 打开事件查看器，在应用程序选项里面找到 Microsoft-Windows-CommandProcessor/Operational，可以查看操作历史。</p>
<p>linux 的操作历史保存在 .bash_history 里面，可以用命令 cat ~/.bash_history | grep “whoami” 进行查看。</p>
<hr>
<h2 id="java-类问题">java 类问题</h2>
<hr>
<h3 id="java-内存马的原理">java 内存马的原理</h3>
<p>客户端向 java web 服务器发起的请求会依次经过 listener，filter，servlet 三个组件。</p>
<p>java 内存马的原理就是利用类加载或 Agent 机制在 JavaEE、框架或中间件的 API 中动态注册一个可访问的后门。</p>
<p>java 内存马分为两类：servlet-api 型内存马，动态注册 web 组件；字节码增强型内存马，通过 instrumentation 动态修改已有代码。</p>
<p>动态注册是指通过 rce 注册新的 listener，filter，servlet 组件，或者特殊框架的特殊组件，例如 spring 的 controller 内存马，tomcat 的 valve 内存马。</p>
<hr>
<h3 id="java-web-中-servletfilterlistener-的区别">java web 中 servlet/filter/listener 的区别</h3>
<p>servlet 是处理请求的动态资源；filter 是过滤器，可以修改请求和响应；listener 是监听器，可以监听并加载一些插件。</p>
<p>servlet: 冰蝎内存马</p>
<p>filter: struts2</p>
<p>listener: spring, log4j</p>
<hr>
<h3 id="怎样排查内存马">怎样排查内存马</h3>
<p>（1）heapdump 内存排查。用 heapdump 和 grep 命令进行查找。</p>
<pre><code>heapdump

strings /var/cache/tomcat/temp/heapdump2022-10-19-12-464292342944555007800.hprof | grep &quot;POST /&quot;

strings /var/cache/tomcat/temp/heapdump2022-10-19-12-464292342944555007800.hprof | grep -E &quot;/webapps/.*?\!&quot; | sort -u
</code></pre>
<p>（2）如果是 jsp 注入，在日志文件中排查 jsp 的访问请求，通过特征查找内存马</p>
<pre><code>find / -name *.jsp | xargs grep &quot;pass&quot; 
</code></pre>
<p>（3）如果是 rce，查看中间件的 error.log，判断攻击时间和手法；</p>
<p>（4）根据告警的 url 查找日志，大量相同路径不同参数的请求，页面不存在但是返回 200 则可能有内存马。</p>
<p>（5）特殊的 classloader 加载（例如 Templateslmpl 和 bcel），对应的 classloader 路径下没有 class 文件。</p>
<p>（6）结合冰蝎和哥斯拉的 webshell 流量特征进行判断。</p>
<p>（7）利用检测工具（arthas/牧云，java instrument 技术），检测 filter 类型，agent 类型。</p>
<hr>
<h4 id="怎样清除内存马">怎样清除内存马</h4>
<p>删除 filter 中的恶意代码。</p>
<p>中间件注销 filter。</p>
<p>使用工具 arthas，VisualVM</p>
<hr>
<h4 id="内存马无文件落地怎么取证">内存马无文件落地，怎么取证</h4>
<p>/var/log/ 日志取证，结合流量特征用 grep 命令按照正则表达式搜索；/var/cache 缓存取证，结合流量特征用 grep 命令按照正则表达式搜索；检测工具，例如 arthas。</p>
<hr>
<h3 id="java-反序列化漏洞概述">java 反序列化漏洞概述</h3>
<p>字节流变为 java 对象称为反序列化，反之称为序列化。由于 java 反序列化方法的不慎调用，用户在 http 报文输入的字节流能够被后端当作 java 对象解析。因此攻击者可以利用这个漏洞构造恶意语句交给后端执行。主要危害是 rce 和 dos，现实中一般需要多个漏洞配合利用才能造成实际危害，称为反序列化利用链。</p>
<hr>
<h4 id="java-反序列化利用工具">java 反序列化利用工具</h4>
<p>ysoserial 集成了很多利用链，只需要查看网站的第三方组件，然后在 ysoserial 里面找对应的利用链。</p>
<hr>
<h3 id="jndi-注入是什么">jndi 注入是什么</h3>
<p>jndi 是 java 接口，可以访问命名和目录服务。jndi 的 lookup 方法的 uri 参数可控，攻击者注入一个恶意 url，存储一个 java payload，这个 url 被加载时 payload 被解析，造成了注入攻击。</p>
<hr>
<h3 id="rmi-是什么">rmi 是什么</h3>
<p>rmi 即远程方法调用，分为三个部分：客户端进行方法的调用，服务端提供方法、对代码进行解析，注册中心相当于一个字典，客户端调用服务端的方法时在注册中心进行查询和引用。</p>
<hr>
<h3 id="shiro-的流量特征550-和-721-有什么区别">shiro 的流量特征，550 和 721 有什么区别</h3>
<p>这里 550 和 721 是 apache 官方 issue 的编号，550 影响版本 version &lt;= 1.2.4，而 721 影响版本 1.2.4 &lt; version &lt; 1.4.2。</p>
<p>流量特征：shiro 的 cookie 会有一个 rememberme 的值，并且这个值是很长的一个字符串，采用 base64 编码。</p>
<p>shiro550 使用 aes+base64 加密，密钥写死在代码里面。知道了密钥可以碰撞解密，写 payload 再加密，替换原来的 rememberme 字段，这个 rememberme 最终被反序列化，payload 被后端解析。</p>
<p>shiro721 不需要知道 key，但是需要一个合法登录用户的 cookie 进行 padding oracle 填充攻击。</p>
<hr>
<h3 id="shiro-利用链">shiro 利用链</h3>
<p>无依赖利用链，具体情况可以使用工具 ysoserial。</p>
<p>因为我们知道 Shiro 原生类中是不存在 Commons-Collection 依赖的，所以当没有 CC 依赖的时候我们就无法通过 CC 链进行攻击，我们就需要另外找一个无依赖的方式对 Shiro 的反序列化漏洞进行利用：例如通过 Shiro 自带的依赖 Commons-Beanutils 进行攻击。</p>
<hr>
<h3 id="log4j2-的原理怎么判断是否利用成功">log4j2 的原理，怎么判断是否利用成功</h3>
<p>log4j2 是日志组件，其 lookups 机制存在 jndi 注入。</p>
<p>判断利用是否成功：（1）出网一般走 rmi/ldap/dns，配合 ids 查看目标主机是否外带攻击；（2）查看目标主机是否存在 dnslog 活动；（3）查看是否下载恶意类。</p>
<hr>
<h3 id="log4j2-的流量特征">log4j2 的流量特征</h3>
<p>log4j2 的特征是 ${}，例如 ${jndi:ldap://0.0.0.0:80/exploit}</p>
<p>log4j2 使用 jndi 注入，找恶意 url。</p>
<p>log4j2 流量可以看到 rmi 或者 ldap 字样。</p>
<p>log4j2 流量会出现 dns/ip 相关特征。</p>
<p>log4j2 混淆绕过会使用冒号，例如 ${::::-j}${what:-n}</p>
<p>log4j2 的影响范围包括：log4j1.x，spring boot，struts2, solr, vmware 产品线, flink, druid</p>
<hr>
<h3 id="已知攻击者正在利用-log4j2-漏洞怎么应急">已知攻击者正在利用 log4j2 漏洞，怎么应急</h3>
<p>隔离被攻击的主机，判断影响范围。</p>
<p>根据 log4j2 特征 ${jndi} 在日志中进行搜索，找到漏洞点和攻击者信息，封禁攻击者 ip。</p>
<p>在防火墙的出站策略中阻断对常见 dnslog 平台的访问。</p>
<p>排查内存马并清除。</p>
<p>通知客户升级组件，进行安全加固。</p>
<p>对攻击者进行溯源，协助恢复业务，输出报告。</p>
<hr>
<h3 id="struts2-反序列化原理">struts2 反序列化原理</h3>
<p>Struts2 对标签属性执行 ognl（对象图形导航语言）解析，可造成 rce。</p>
<hr>
<h3 id="struts2-的流量特征">struts2 的流量特征</h3>
<p>struts 2 的特征是 %{}（或是其 url 编码 %25%7B&hellip;%7D），并且请求体和响应体都包含 payload。</p>
<p>struts2 文件类型基本上是 .action 和 .jsp 文件。</p>
<hr>
<h3 id="weblogic-的流量特征">weblogic 的流量特征</h3>
<p>无强特征，请求体和响应体看到大段 java 代码则预判为攻击流量。</p>
<hr>
<h3 id="weblogic-历史漏洞">weblogic 历史漏洞</h3>
<p>（1）t3 协议引起的反序列化漏洞；（2）Gadget 造成的 rce；（3）任意文件上传；（4）ssrf。</p>
<hr>
<h3 id="fastjson-反序列化的原理">fastjson 反序列化的原理</h3>
<p>fastjson 在解析 json 数据时存在自动类型转换功能（autoType），fastjson 就会自动解析 @type 参数字段，利用该功能构造恶意 json 数据，使其在反序列化过程中触发漏洞利用链，从而实现恶意代码的执行。</p>
<hr>
<h3 id="fastjson-的流量特征">fastjson 的流量特征</h3>
<p>fastjson 的强特征是 json 数据以 @type 开头。</p>
<p>fastjson 用 json 传参，恶意流量的 json 参数含有 java 代码。</p>
<p>fastjson 流量会看到 rmi 或者 ldap 字样。</p>
<p>fastjson 的利用链 cc3、cc5 等，fastjson 有很多高危类。</p>
<hr>
<h4 id="fastjson-rce-流程">fastjson rce 流程</h4>
<p>fastjson 将 java 对象序列化为 json 字节流，将 json 字节流反序列化为 java 对象。fastjson 使用 rmi 或者 ldap 协议（远程方法调用、情形目录访问）。</p>
<p>简单描述一下 fastjson rce 的流程。攻击者的 payload 被受害者的服务器反序列化解析后，通过 jndi 连接攻击者指定的 rmi 服务器。攻击者 rmi 服务器向受害者服务器返回一个对象。受害者服务器检测到本地不存在该对象，向攻击者提供的地址请求恶意 class 文件。受害者服务器收到 class 文件后加载进内存，实例化的时候执行构造函数，完成 rce。</p>
<hr>
<h3 id="fastjson-不出网怎么利用">fastjson 不出网怎么利用</h3>
<p>TemplatesImpl 利用链：利用条件比较苛刻，需要 parse() 和 parseObject() 满足特殊格式，一些数据的属性要满足 private 属性。</p>
<p>becl 攻击：利用 tomcat 的 BasicDataSource 链编译 poc，将 poc 的 class 字节码转化为 bcel 然后发送 payload。</p>
<hr>
<h3 id="log4j2-和-fastjson-联动">log4j2 和 fastjson 联动</h3>
<hr>
<h2 id="红蓝对抗问题">红蓝对抗问题</h2>
<hr>
<h3 id="cobaltstrike-的流量特征">CobaltStrike 的流量特征</h3>
<p>每隔六十秒发一个心跳包，通过 cookie 携带靶机信息。</p>
<p>大小约等于 211kb 的文件下载，并且下载路径有 checksum8 的特征。</p>
<p>post 请求 url 含有 /submit.php?id=，这是 cs 在回传数据。</p>
<p>形如 0.0.0.241 之类的奇怪 ip，说明已经到了 stageless 阶段。</p>
<hr>
<h3 id="metasploitframework-的流量特征">MetasploitFramework 的流量特征</h3>
<p>msf 默认使用 4444 端口作为反向连接端口。</p>
<p>流量有特殊字符：MZ 标头，cannot be run in DOS mode 字样，&ldquo;meterpreter&rdquo;、&ldquo;revshell&rdquo; 等字样。</p>
<p>心跳包、固定 ua 头。</p>
<hr>
<h3 id="冰蝎的流量特征">冰蝎的流量特征</h3>
<p>冰蝎 behinder 是 webshell 管理工具，和 java 反序列化结合比较多，没有特别明显的强特征。和其他 webshell 管理工具相比，冰蝎的特点是动态加密。</p>
<p>冰蝎 2.0-4.0 弱特征：同一个 ip 短时间频繁更换 user-agent。</p>
<p>冰蝎 2.0-4.0 使用 16 位 md5 作为 aes 密钥。冰蝎 webshell 的默认密钥是 e45e329feb5d925b，即 rebeyond 的 md5 前 16 位。</p>
<p>冰蝎 4.0 有固定的请求头和响应头，请求字节头：dFAXQV1LORcHRQtLRlwMAhwFTAg/M ，响应字节头：TxcWR1NNExZAD0ZaAWMIPAZjH1BFBFtHThcJSlUXWEd。</p>
<p>冰蝎 4.0 会使用例如 49700 之类的比较大的端口进行 tcp 连接，且端口依次增加。</p>
<hr>
<h3 id="菜刀-caidao">菜刀 caidao</h3>
<p>响应体有两个竖杠||。</p>
<p>会使用 base64_decode 函数进行打断 (&quot;@e&quot;.&ldquo;v&rdquo;.&ldquo;al&rdquo;)。</p>
<p>请求体 base64 解码后看到 eval、assert、base64_decode 字样，判断为菜刀 php webshell。</p>
<p>看到 i=A&amp;z0=GB2312 字样，或者 z_1=payload，判断为菜刀 jsp webshell。</p>
<p>请求体 unicode 解码之后看到一句话木马，判断为菜刀 asp webshell。</p>
<hr>
<h3 id="哥斯拉-godzilla">哥斯拉 godzilla</h3>
<p>哥斯拉的强特征是 cookie 后面有个分号，目前版本的哥斯拉无法去除这个特征。</p>
<p>哥斯拉会发三个特定请求。</p>
<hr>
<h3 id="蚁剑-antsword">蚁剑 antsword</h3>
<p>蚁剑的请求体含有 ini_set、set_time_limit、display_errors 字样。</p>
<p>蚁剑的 ua 头为 antsword/v2.1，但是攻击者可以去除这个特征。</p>
<p>蚁剑加密数据包的参数很多以 _0x&hellip; 的形式出现（下划线可替换为其他字符）。</p>
<hr>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2024-05-18</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts">
			Next<br>No newer posts.
                </a>
                
                
                
                <a class="older-posts" href="/posts/sec/python-trojan/">
			Previous<br>基于 python 的无文件木马
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
                <p style="opacity: 0.6" align="center">
                    <small>Comments Disabled.</small>
                </p>
                
            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://xxxhidexxx.github.io/">
    
        <div class="nav-title">
            write-up
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                分类
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	null
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ba%94%e6%80%a5%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-应急类问题">
									应急类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ba%94%e6%80%a5%e9%97%ae%e9%a2%98%e7%9a%84%e5%9b%9e%e7%ad%94%e5%85%ac%e5%bc%8f" class="nav-应急问题的回答公式">
									应急问题的回答公式
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%a0%e5%88%b0%e5%ae%a2%e6%88%b7%e7%8e%b0%e5%9c%ba%e8%bf%9b%e8%a1%8c%e5%ae%89%e5%85%a8%e5%8a%a0%e5%9b%ba%e9%83%bd%e8%a6%81%e5%81%9a%e5%93%aa%e4%ba%9b%e4%ba%8b" class="nav-你到客户现场进行安全加固都要做哪些事">
									你到客户现场进行安全加固都要做哪些事
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e8%ae%be%e5%a4%87%e5%91%8a%e8%ad%a6%e6%98%af%e4%b8%8d%e6%98%af%e8%af%af%e6%8a%a5" class="nav-怎么判断设备告警是不是误报">
									怎么判断设备告警是不是误报
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%94%bb%e5%87%bb%e8%80%85%e5%9c%a8%e5%a4%96%e7%bd%91%e4%bd%86%e6%98%af%e8%ae%be%e5%a4%87%e5%87%ba%e7%8e%b0%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e6%80%8e%e4%b9%88%e8%a7%a3%e9%87%8a%e8%bf%99%e7%a7%8d%e7%8e%b0%e8%b1%a1%e6%80%8e%e4%b9%88%e7%9c%8b%e5%88%b0%e7%9c%9f%e5%ae%9e-ip" class="nav-攻击者在外网但是设备出现内网告警怎么解释这种现象怎么看到真实-ip">
									攻击者在外网，但是设备出现内网告警，怎么解释这种现象，怎么看到真实 ip
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e5%86%85%e7%bd%91%e5%91%8a%e8%ad%a6%e4%b8%ba%e7%9c%9f%e5%ae%9e%e5%a8%81%e8%83%81%e4%bd%a0%e4%bc%9a%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-已知内网告警为真实威胁你会怎么做">
									已知内网告警为真实威胁，你会怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e5%86%85%e7%bd%91%e6%a8%aa%e5%90%91%e7%a7%bb%e5%8a%a8%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-已知内网横向移动怎么办">
									已知内网横向移动，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%b4%a7%e6%80%a5%e9%80%9a%e7%9f%a5-windows-%e7%b3%bb%e7%bb%9f%e6%9c%89%e4%ba%ba%e7%82%b9%e5%87%bb%e9%92%93%e9%b1%bc%e6%96%87%e4%bb%b6%e4%ba%86%e4%bd%a0%e8%b4%9f%e8%b4%a3%e6%8e%92%e6%9f%a5%e8%bf%9c%e7%a8%8b%e6%a1%8c%e9%9d%a2%e5%ba%94%e8%af%a5%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-紧急通知-windows-系统有人点击钓鱼文件了你负责排查远程桌面应该怎么做">
									紧急通知 windows 系统有人点击钓鱼文件了，你负责排查远程桌面，应该怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ddos-%e7%9a%84%e5%8a%a0%e5%9b%ba%e5%92%8c%e5%a4%84%e7%bd%ae" class="nav-ddos-的加固和处置">
									ddos 的加固和处置
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e7%bd%91%e9%a1%b5%e7%af%a1%e6%94%b9%e4%bd%a0%e4%bc%9a%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-发现网页篡改你会怎么做">
									发现网页篡改，你会怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5-webshell-%e4%b8%8a%e4%bc%a0%e4%bd%a0%e5%ba%94%e8%af%a5%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-已知-webshell-上传你应该怎么做">
									已知 webshell 上传，你应该怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5-dns-%e5%91%8a%e8%ad%a6%e4%b8%80%e5%ae%9a%e6%98%af%e6%84%9f%e6%9f%93%e5%90%97%e5%8f%af%e8%83%bd%e7%9a%84%e5%8e%9f%e5%9b%a0%e6%98%af%e4%bb%80%e4%b9%88" class="nav-已知-dns-告警一定是感染吗可能的原因是什么">
									已知 DNS 告警，一定是感染吗，可能的原因是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%b7%b2%e7%bb%8f%e4%b8%ad%e4%ba%86%e5%8b%92%e7%b4%a2%e7%97%85%e6%af%92%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-发现已经中了勒索病毒怎么办">
									发现已经中了勒索病毒，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%b7%b2%e7%bb%8f%e4%b8%ad%e4%ba%86%e6%8c%96%e7%9f%bf%e6%9c%a8%e9%a9%ac%e6%80%8e%e4%b9%88%e5%8a%9e" class="nav-发现已经中了挖矿木马怎么办">
									发现已经中了挖矿木马，怎么办
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e8%ae%be%e5%a4%87%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-设备类问题">
									设备类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89" class="nav-天眼每个字段的含义">
									天眼每个字段的含义
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e7%9a%84%e7%bb%93%e6%9e%9c%e9%99%a4%e4%ba%86%e6%88%90%e5%8a%9f%e8%bf%98%e6%9c%89%e5%93%aa%e4%ba%9b%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad" class="nav-天眼告警的结果除了成功还有哪些怎么判断">
									天眼告警的结果除了成功还有哪些，怎么判断
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%86%85%e7%bd%91%e6%a8%aa%e5%90%91%e7%9a%84%e5%91%8a%e8%ad%a6%e7%b1%bb%e5%9e%8b" class="nav-天眼内网横向的告警类型">
									天眼内网横向的告警类型
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e9%80%9a%e8%bf%87%e5%a4%a9%e7%9c%bc%e5%88%a4%e6%96%ad%e8%b5%84%e4%ba%a7%e6%98%af%e5%90%a6%e5%a4%b1%e9%99%b7" class="nav-怎么通过天眼判断资产是否失陷">
									怎么通过天眼判断资产是否失陷
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%91%e7%8e%b0%e5%a4%a9%e7%9c%bc%e4%b8%ad%e5%8f%97%e5%ae%b3-ip-%e4%b8%ba%e6%ba%90-ip%e6%80%8e%e4%b9%88%e8%a7%a3%e9%87%8a" class="nav-发现天眼中受害-ip-为源-ip怎么解释">
									发现天眼中受害 ip 为源 ip，怎么解释
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%88%86%e6%9e%90%e5%b9%b3%e5%8f%b0%e4%b8%ad-ioc-%e8%a1%a8%e7%a4%ba%e4%bb%80%e4%b9%88%e5%90%ab%e4%b9%89%e5%8f%8d%e6%98%a0%e4%ba%86%e4%bb%80%e4%b9%88" class="nav-天眼分析平台中-ioc-表示什么含义反映了什么">
									天眼分析平台中 IOC 表示什么含义，反映了什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%88%86%e6%9e%90%e5%b9%b3%e5%8f%b0%e7%9a%84%e8%bf%90%e7%ae%97%e7%ac%a6%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-天眼分析平台的运算符有哪些">
									天眼分析平台的运算符有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e4%b8%80%e4%b8%aa%e5%a4%a9%e7%9c%bc%e6%97%a5%e5%bf%97%e8%a6%81%e6%b1%82%e6%90%9c%e7%b4%a2-80-%e5%92%8c-443-%e7%ab%af%e5%8f%a3%e7%9a%84%e8%ae%b0%e5%bd%95%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-给定一个天眼日志要求搜索-80-和-443-端口的记录怎么做">
									给定一个天眼日志，要求搜索 80 和 443 端口的记录，怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%bb%99%e5%ae%9a%e4%b8%80%e4%b8%aa%e5%a4%a9%e7%9c%bc%e6%97%a5%e5%bf%97%e8%a6%81%e6%b1%82%e6%90%9c%e7%b4%a2%e6%ba%90-ip-%e4%b8%ba-a-%e5%b9%b6%e4%b8%94%e7%9b%ae%e7%9a%84-ip-%e4%b8%ba-b-%e7%9a%84%e6%97%a5%e5%bf%97%e6%80%8e%e4%b9%88%e5%81%9a" class="nav-给定一个天眼日志要求搜索源-ip-为-a-并且目的-ip-为-b-的日志怎么做">
									给定一个天眼日志，要求搜索源 ip 为 A 并且目的 ip 为 B 的日志，怎么做
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e6%a8%a1%e7%b3%8a%e6%90%9c%e7%b4%a2%e6%80%8e%e4%b9%88%e5%86%99%e6%9f%a5%e8%af%a2%e8%af%ad%e5%8f%a5" class="nav-天眼模糊搜索怎么写查询语句">
									天眼模糊搜索怎么写查询语句
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e4%b8%bb%e6%9c%ba%e5%a4%96%e8%81%94%e6%b5%81%e9%87%8f%e6%80%8e%e4%b9%88%e6%8e%92%e6%9f%a5" class="nav-天眼告警主机外联流量怎么排查">
									天眼告警主机外联流量，怎么排查
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%a9%e7%9c%bc%e5%91%8a%e8%ad%a6%e6%98%be%e7%a4%ba%e6%88%90%e5%8a%9f%e5%88%a9%e7%94%a8%e6%80%8e%e4%b9%88%e5%a4%84%e7%90%86" class="nav-天眼告警显示成功利用怎么处理">
									天眼告警显示成功利用，怎么处理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%a8%e8%bf%87-edr-%e8%ae%be%e5%a4%87%e5%90%97" class="nav-用过-edr-设备吗">
									用过 edr 设备吗
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b8%b8%e7%94%a8%e7%9a%84-wireshark-%e8%bf%87%e6%bb%a4%e8%af%ad%e6%b3%95%e6%9c%89%e5%93%aa%e4%ba%9b" class="nav-常用的-wireshark-过滤语法有哪些">
									常用的 wireshark 过滤语法有哪些
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%b8%b8%e8%af%86%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-常识类问题">
									常识类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0%e6%9c%89%e5%93%aa%e4%ba%9b%e9%99%90%e5%88%b6%e6%80%8e%e4%b9%88%e7%bb%95%e8%bf%87" class="nav-文件上传有哪些限制怎么绕过">
									文件上传有哪些限制，怎么绕过
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#redis-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e5%9c%a8%e4%bb%80%e4%b9%88%e6%9d%a1%e4%bb%b6%e4%b8%8b%e8%83%bd%e5%81%9a%e5%88%b0-rce%e6%80%8e%e4%b9%88%e5%8a%a0%e5%9b%ba" class="nav-redis-未授权访问在什么条件下能做到-rce怎么加固">
									redis 未授权访问在什么条件下能做到 rce，怎么加固
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#ssrf-%e7%94%a8-redis-%e6%8f%90%e5%8d%87%e4%b8%ba-rce" class="nav-ssrf-用-redis-提升为-rce">
									ssrf 用 redis 提升为 rce
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e4%b9%88%e7%9c%8b-webshell-%e7%9a%84%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e5%8e%86%e5%8f%b2" class="nav-怎么看-webshell-的命令执行历史">
									怎么看 webshell 的命令执行历史
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#java-%e7%b1%bb%e9%97%ae%e9%a2%98" class="nav-java-类问题">
									java 类问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#java-%e5%86%85%e5%ad%98%e9%a9%ac%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-java-内存马的原理">
									java 内存马的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java-web-%e4%b8%ad-servletfilterlistener-%e7%9a%84%e5%8c%ba%e5%88%ab" class="nav-java-web-中-servletfilterlistener-的区别">
									java web 中 servlet/filter/listener 的区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%8e%92%e6%9f%a5%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样排查内存马">
									怎样排查内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%80%8e%e6%a0%b7%e6%b8%85%e9%99%a4%e5%86%85%e5%ad%98%e9%a9%ac" class="nav-怎样清除内存马">
									怎样清除内存马
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%85%e5%ad%98%e9%a9%ac%e6%97%a0%e6%96%87%e4%bb%b6%e8%90%bd%e5%9c%b0%e6%80%8e%e4%b9%88%e5%8f%96%e8%af%81" class="nav-内存马无文件落地怎么取证">
									内存马无文件落地，怎么取证
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%bc%8f%e6%b4%9e%e6%a6%82%e8%bf%b0" class="nav-java-反序列化漏洞概述">
									java 反序列化漏洞概述
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#java-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%88%a9%e7%94%a8%e5%b7%a5%e5%85%b7" class="nav-java-反序列化利用工具">
									java 反序列化利用工具
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#jndi-%e6%b3%a8%e5%85%a5%e6%98%af%e4%bb%80%e4%b9%88" class="nav-jndi-注入是什么">
									jndi 注入是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#rmi-%e6%98%af%e4%bb%80%e4%b9%88" class="nav-rmi-是什么">
									rmi 是什么
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81550-%e5%92%8c-721-%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" class="nav-shiro-的流量特征550-和-721-有什么区别">
									shiro 的流量特征，550 和 721 有什么区别
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#shiro-%e5%88%a9%e7%94%a8%e9%93%be" class="nav-shiro-利用链">
									shiro 利用链
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e7%9a%84%e5%8e%9f%e7%90%86%e6%80%8e%e4%b9%88%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e5%88%a9%e7%94%a8%e6%88%90%e5%8a%9f" class="nav-log4j2-的原理怎么判断是否利用成功">
									log4j2 的原理，怎么判断是否利用成功
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-log4j2-的流量特征">
									log4j2 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%b7%b2%e7%9f%a5%e6%94%bb%e5%87%bb%e8%80%85%e6%ad%a3%e5%9c%a8%e5%88%a9%e7%94%a8-log4j2-%e6%bc%8f%e6%b4%9e%e6%80%8e%e4%b9%88%e5%ba%94%e6%80%a5" class="nav-已知攻击者正在利用-log4j2-漏洞怎么应急">
									已知攻击者正在利用 log4j2 漏洞，怎么应急
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#struts2-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%8e%9f%e7%90%86" class="nav-struts2-反序列化原理">
									struts2 反序列化原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#struts2-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-struts2-的流量特征">
									struts2 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#weblogic-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-weblogic-的流量特征">
									weblogic 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#weblogic-%e5%8e%86%e5%8f%b2%e6%bc%8f%e6%b4%9e" class="nav-weblogic-历史漏洞">
									weblogic 历史漏洞
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e5%8e%9f%e7%90%86" class="nav-fastjson-反序列化的原理">
									fastjson 反序列化的原理
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#fastjson-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-fastjson-的流量特征">
									fastjson 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#fastjson-rce-%e6%b5%81%e7%a8%8b" class="nav-fastjson-rce-流程">
									fastjson rce 流程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#fastjson-%e4%b8%8d%e5%87%ba%e7%bd%91%e6%80%8e%e4%b9%88%e5%88%a9%e7%94%a8" class="nav-fastjson-不出网怎么利用">
									fastjson 不出网怎么利用
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#log4j2-%e5%92%8c-fastjson-%e8%81%94%e5%8a%a8" class="nav-log4j2-和-fastjson-联动">
									log4j2 和 fastjson 联动
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%ba%a2%e8%93%9d%e5%af%b9%e6%8a%97%e9%97%ae%e9%a2%98" class="nav-红蓝对抗问题">
									红蓝对抗问题
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#cobaltstrike-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-cobaltstrike-的流量特征">
									CobaltStrike 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#metasploitframework-%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-metasploitframework-的流量特征">
									MetasploitFramework 的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%86%b0%e8%9d%8e%e7%9a%84%e6%b5%81%e9%87%8f%e7%89%b9%e5%be%81" class="nav-冰蝎的流量特征">
									冰蝎的流量特征
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%8f%9c%e5%88%80-caidao" class="nav-菜刀-caidao">
									菜刀 caidao
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%93%a5%e6%96%af%e6%8b%89-godzilla" class="nav-哥斯拉-godzilla">
									哥斯拉 godzilla
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%9a%81%e5%89%91-antsword" class="nav-蚁剑-antsword">
									蚁剑 antsword
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	null
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
